(()=>{var e={};e.id=232,e.ids=[232],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},98061:e=>{"use strict";e.exports=require("node:assert")},92761:e=>{"use strict";e.exports=require("node:async_hooks")},72254:e=>{"use strict";e.exports=require("node:buffer")},40027:e=>{"use strict";e.exports=require("node:console")},6005:e=>{"use strict";e.exports=require("node:crypto")},65714:e=>{"use strict";e.exports=require("node:diagnostics_channel")},15673:e=>{"use strict";e.exports=require("node:events")},88849:e=>{"use strict";e.exports=require("node:http")},42725:e=>{"use strict";e.exports=require("node:http2")},87503:e=>{"use strict";e.exports=require("node:net")},38846:e=>{"use strict";e.exports=require("node:perf_hooks")},39630:e=>{"use strict";e.exports=require("node:querystring")},84492:e=>{"use strict";e.exports=require("node:stream")},31764:e=>{"use strict";e.exports=require("node:tls")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},93746:e=>{"use strict";e.exports=require("node:util/types")},24086:e=>{"use strict";e.exports=require("node:worker_threads")},65628:e=>{"use strict";e.exports=require("node:zlib")},95214:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>d}),t(27626),t(36852),t(35866);var r=t(23191),a=t(88716),i=t(37922),l=t.n(i),n=t(95231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["leases",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,27626)),"/Users/memimal/Desktop/PROJECTS/MMG/mmg-platform/app/leases/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,36852)),"/Users/memimal/Desktop/PROJECTS/MMG/mmg-platform/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/memimal/Desktop/PROJECTS/MMG/mmg-platform/app/leases/page.tsx"],x="/leases/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/leases/page",pathname:"/leases",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},70026:(e,s,t)=>{Promise.resolve().then(t.bind(t,51772))},51772:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>C});var r=t(10326),a=t(88455),i=t(17577),l=t(90434),n=t(19395),c=t(33071),d=t(567),o=t(90772),x=t(54432),u=t(34474),h=t(43273),m=t(65304),p=t(83855),j=t(41291),g=t(88307),f=t(36283),y=t(15919),v=t(12714),N=t(69508),w=t(98091),q=t(24061),b=t(29798),k=t(71821),Z=t(37358),M=t(60097),O=t(45804),_=t(19008);function P({onLeaseSelect:e}){let{user:s}=(0,n.aC)(),[t,a]=(0,i.useState)([]),[P,C]=(0,i.useState)(!0),[I,E]=(0,i.useState)(""),[S,A]=(0,i.useState)(""),[D,z]=(0,i.useState)("all"),G=async e=>{if(confirm("Are you sure you want to delete this lease? This action cannot be undone."))try{await (0,_.fj)(e),a(s=>s.filter(s=>s.id!==e))}catch(e){E(e.message)}},L=t.filter(e=>{if(!S)return!0;let s=S.toLowerCase();return e.tenantId.toLowerCase().includes(s)||e.unitId.toLowerCase().includes(s)}),T=e=>({draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",notice_given:"bg-yellow-100 text-yellow-800",expired:"bg-red-100 text-red-800",terminated:"bg-red-100 text-red-800"})[e],U=e=>({draft:"Draft",active:"Active",notice_given:"Notice Given",expired:"Expired",terminated:"Terminated"})[e];return P&&0===t.length?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx(m.O,{className:"h-8 w-48"}),r.jsx(m.O,{className:"h-4 w-64 mt-2"})]}),r.jsx(m.O,{className:"h-10 w-32"})]}),r.jsx(c.Zb,{children:r.jsx(c.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[r.jsx(m.O,{className:"h-10 flex-1"}),r.jsx(m.O,{className:"h-10 w-32"}),r.jsx(m.O,{className:"h-10 w-32"})]})})}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,r.jsxs)(c.Zb,{children:[r.jsx(c.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx(m.O,{className:"h-5 w-32"}),r.jsx(m.O,{className:"h-6 w-16"})]})}),r.jsx(c.aY,{children:(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx(m.O,{className:"h-4 w-full"}),r.jsx(m.O,{className:"h-4 w-full"}),r.jsx(m.O,{className:"h-8 w-full"})]})})]},e))})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Lease Agreements"}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:["Manage lease agreements and tenant relationships (",t.length," leases)"]})]}),(s?.role==="admin"||s?.role==="agent")&&r.jsx(o.z,{asChild:!0,children:(0,r.jsxs)(l.default,{href:"/leases/new",children:[r.jsx(p.Z,{className:"mr-2 h-4 w-4"}),"New Lease"]})})]}),I&&(0,r.jsxs)(h.bZ,{variant:"destructive",children:[r.jsx(j.Z,{className:"h-4 w-4"}),r.jsx(h.X,{children:I})]}),r.jsx(c.Zb,{children:r.jsx(c.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsx("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx(g.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),r.jsx(x.I,{placeholder:"Search by tenant or unit...",className:"pl-8",value:S,onChange:e=>A(e.target.value)})]})}),(0,r.jsxs)(u.Ph,{value:D,onValueChange:e=>z(e),children:[r.jsx(u.i4,{className:"w-[180px]",children:r.jsx(u.ki,{placeholder:"Status"})}),(0,r.jsxs)(u.Bw,{children:[r.jsx(u.Ql,{value:"all",children:"All Status"}),r.jsx(u.Ql,{value:"draft",children:"Draft"}),r.jsx(u.Ql,{value:"active",children:"Active"}),r.jsx(u.Ql,{value:"notice_given",children:"Notice Given"}),r.jsx(u.Ql,{value:"expired",children:"Expired"}),r.jsx(u.Ql,{value:"terminated",children:"Terminated"})]})]})]})})}),0!==L.length||P?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:L.map(t=>(0,r.jsxs)(c.Zb,{className:"hover:shadow-lg transition-shadow",children:[r.jsx(c.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(f.Z,{className:"h-5 w-5 text-muted-foreground"}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium",children:"Lease Agreement"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["ID: ",t.id.slice(0,8),"..."]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(d.C,{className:T(t.status),children:U(t.status)}),(0,r.jsxs)(M.h_,{children:[r.jsx(M.$F,{asChild:!0,children:r.jsx(o.z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:r.jsx(y.Z,{className:"h-4 w-4"})})}),(0,r.jsxs)(M.AW,{align:"end",children:[r.jsx(M.Xi,{asChild:!0,children:(0,r.jsxs)(l.default,{href:`/leases/${t.id}`,children:[r.jsx(v.Z,{className:"mr-2 h-4 w-4"}),"View Details"]})}),(s?.role==="admin"||s?.role==="agent")&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(M.Xi,{asChild:!0,children:(0,r.jsxs)(l.default,{href:`/leases/${t.id}/edit`,children:[r.jsx(N.Z,{className:"mr-2 h-4 w-4"}),"Edit"]})}),(0,r.jsxs)(M.Xi,{onClick:()=>G(t.id),className:"text-red-600",children:[r.jsx(w.Z,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]})]})}),r.jsx(c.aY,{children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[r.jsx(q.Z,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,r.jsxs)("span",{children:["Tenant: ",t.tenantId.slice(0,8),"..."]})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[r.jsx(b.Z,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,r.jsxs)("span",{children:["Unit: ",t.unitId.slice(0,8),"..."]})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[r.jsx(k.Z,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,r.jsxs)("span",{children:[t.terms.currency," ",t.terms.rentAmount.toLocaleString(),"/",t.terms.paymentFrequency]})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[r.jsx(Z.Z,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,r.jsxs)("span",{children:[(0,O.WU)(t.dates.startDate.toDate(),"MMM dd, yyyy")," - ",(0,O.WU)(t.dates.endDate.toDate(),"MMM dd, yyyy")]})]}),(0,r.jsxs)("div",{className:"flex justify-between pt-3 border-t",children:[(0,r.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>e?.(t.id),children:[r.jsx(v.Z,{className:"w-3 h-3 mr-1"}),"View"]}),r.jsx("div",{className:"space-x-2",children:"active"===t.status&&r.jsx(o.z,{variant:"outline",size:"sm",asChild:!0,children:(0,r.jsxs)(l.default,{href:`/leases/${t.id}/renew`,children:[r.jsx(Z.Z,{className:"w-3 h-3 mr-1"}),"Renew"]})})})]})]})})]},t.id))}):r.jsx(c.Zb,{children:(0,r.jsxs)(c.aY,{className:"pt-6 text-center",children:[r.jsx(f.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No leases found"}),r.jsx("p",{className:"text-gray-600 mb-4",children:S?"No leases match your search criteria.":"Get started by creating your first lease agreement."}),(s?.role==="admin"||s?.role==="agent")&&!S&&r.jsx(o.z,{asChild:!0,children:(0,r.jsxs)(l.default,{href:"/leases/new",children:[r.jsx(p.Z,{className:"mr-2 h-4 w-4"}),"New Lease"]})})]})}),P&&t.length>0&&r.jsx("div",{className:"text-center py-4",children:(0,r.jsxs)("div",{className:"inline-flex items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Loading more leases..."]})})]})}function C(){return r.jsx(a.Z,{allowedRoles:["admin","agent","owner"],children:r.jsx(P,{})})}},54041:(e,s,t)=>{"use strict";t.d(s,{E2:()=>l,lK:()=>c,vw:()=>n,zI:()=>d});var r=t(76);t(11552);var a=t(20902);let i=(0,r.hJ)(a.db,"properties"),l=async e=>{try{let s=(0,r.JU)(a.db,"properties",e);await (0,r.oe)(s)}catch(e){throw console.error("Error deleting property:",e),e}},n=async(e={})=>{try{let s=(0,r.IO)(i);e.ownerId&&(s=(0,r.IO)(s,(0,r.ar)("ownerId","==",e.ownerId))),e.assignedAgentId&&(s=(0,r.IO)(s,(0,r.ar)("assignedAgents","array-contains",e.assignedAgentId))),e.type&&(s=(0,r.IO)(s,(0,r.ar)("type","==",e.type))),e.status&&(s=(0,r.IO)(s,(0,r.ar)("status","==",e.status))),s=(0,r.IO)(s,(0,r.Xo)("createdAt","desc")),e.pageSize&&(s=(0,r.IO)(s,(0,r.b9)(e.pageSize))),e.lastDoc&&(s=(0,r.IO)(s,(0,r.TQ)(e.lastDoc)));let t=await (0,r.PL)(s),a=[];return t.forEach(e=>{a.push({id:e.id,...e.data()})}),{properties:a,lastDoc:t.docs[t.docs.length-1],hasMore:t.docs.length===(e.pageSize||0)}}catch(e){throw console.error("Error getting properties:",e),e}},c=async(e,s=10)=>{try{let t=(0,r.IO)(i,(0,r.ar)("name",">=",e),(0,r.ar)("name","<=",e+""),(0,r.Xo)("name"),s(s)),a=await (0,r.PL)(t),l=[];return a.forEach(e=>{l.push({id:e.id,...e.data()})}),l}catch(e){throw console.error("Error searching properties:",e),e}},d=async(e,s,t)=>{try{let i=(0,r.JU)(a.db,"properties",e);await (0,r.r7)(i,{totalUnits:s,occupiedUnits:t,updatedAt:(0,r.Bt)()})}catch(e){throw console.error("Error updating property occupancy:",e),e}}},71821:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(62881).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},36283:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(62881).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},24061:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(62881).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},27626:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/memimal/Desktop/PROJECTS/MMG/mmg-platform/app/leases/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[100,825,423,344,804,506,404,799,307,967,8,89],()=>t(95214));module.exports=r})();