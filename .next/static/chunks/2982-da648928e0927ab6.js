"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2982],{35974:function(e,t,r){r.d(t,{C:function(){return o}});var s=r(57437);r(2265);var n=r(90535),a=r(94508);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,...n}=e;return(0,s.jsx)("div",{className:(0,a.cn)(i({variant:r}),t),...n})}},84190:function(e,t,r){r.d(t,{$F:function(){return c},AW:function(){return m},Ju:function(){return p},VD:function(){return g},Xi:function(){return f},h_:function(){return d}});var s=r(57437),n=r(2265),a=r(70085),i=r(10407),o=r(30401),l=r(40519),u=r(94508);let d=a.fC,c=a.xz;a.ZA,a.Uv,a.Tr,a.Ee,n.forwardRef((e,t)=>{let{className:r,inset:n,children:o,...l}=e;return(0,s.jsxs)(a.fF,{ref:t,className:(0,u.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",r),...l,children:[o,(0,s.jsx)(i.Z,{className:"ml-auto"})]})}).displayName=a.fF.displayName,n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(a.tu,{ref:t,className:(0,u.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...n})}).displayName=a.tu.displayName;let m=n.forwardRef((e,t)=>{let{className:r,sideOffset:n=4,...i}=e;return(0,s.jsx)(a.Uv,{children:(0,s.jsx)(a.VY,{ref:t,sideOffset:n,className:(0,u.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...i})})});m.displayName=a.VY.displayName;let f=n.forwardRef((e,t)=>{let{className:r,inset:n,...i}=e;return(0,s.jsx)(a.ck,{ref:t,className:(0,u.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",r),...i})});f.displayName=a.ck.displayName,n.forwardRef((e,t)=>{let{className:r,children:n,checked:i,...l}=e;return(0,s.jsxs)(a.oC,{ref:t,className:(0,u.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:i,...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(a.wU,{children:(0,s.jsx)(o.Z,{className:"h-4 w-4"})})}),n]})}).displayName=a.oC.displayName,n.forwardRef((e,t)=>{let{className:r,children:n,...i}=e;return(0,s.jsxs)(a.Rk,{ref:t,className:(0,u.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(a.wU,{children:(0,s.jsx)(l.Z,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=a.Rk.displayName;let p=n.forwardRef((e,t)=>{let{className:r,inset:n,...i}=e;return(0,s.jsx)(a.__,{ref:t,className:(0,u.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",r),...i})});p.displayName=a.__.displayName;let g=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(a.Z0,{ref:t,className:(0,u.cn)("-mx-1 my-1 h-px bg-muted",r),...n})});g.displayName=a.Z0.displayName},95186:function(e,t,r){r.d(t,{I:function(){return i}});var s=r(57437),n=r(2265),a=r(94508);let i=n.forwardRef((e,t)=>{let{className:r,type:n,...i}=e;return(0,s.jsx)("input",{type:n,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},93022:function(e,t,r){r.d(t,{O:function(){return a}});var s=r(57437),n=r(94508);function a(e){let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)("animate-pulse rounded-md bg-muted",t),...r})}},3612:function(e,t,r){r.d(t,{AuthProvider:function(){return u},aC:function(){return d}});var s=r(57437),n=r(2265),a=r(5978),i=r(16023),o=r(17293);let l=(0,n.createContext)(void 0);function u(e){let{children:t}=e,[r,u]=(0,n.useState)(null),[d,c]=(0,n.useState)(null),[m,f]=(0,n.useState)(!0),p=async()=>{if(d)try{let e=await (0,i.Ts)();u(e)}catch(e){console.error("Error fetching user data:",e)}},g=async()=>{try{await (0,i.Mx)(),u(null),c(null)}catch(e){throw console.error("Error signing out:",e),e}};return(0,n.useEffect)(()=>{if(!(0,o.Wn)()){f(!1);return}let e=(0,i.yv)(async e=>{if(c(e),e){let t=(0,a.JU)(o.db,"users",e.uid),r=(0,a.cf)(t,t=>{t.exists()?u({...t.data(),id:e.uid}):u(null),f(!1)},e=>{console.error("Error listening to user document:",e),u(null),f(!1)});return()=>r()}u(null),f(!1)});return()=>e()},[]),(0,s.jsx)(l.Provider,{value:{user:r,firebaseUser:d,loading:m,signOut:g,refreshUser:p},children:t})}function d(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},36910:function(e,t,r){r.d(t,{Y_:function(){return i},mn:function(){return a}}),r(57437),r(2265);var s=r(16023);let n=[{path:"/admin",roles:["admin"],requiresMFA:!0},{path:"/admin/audit",roles:["admin"],permissions:["audit_logs"],requiresMFA:!0},{path:"/admin/users",roles:["admin"],permissions:["manage_users"],requiresMFA:!0},{path:"/dashboard",roles:["admin","owner","agent","tenant"]},{path:"/properties",roles:["admin","owner","agent"],permissions:["view_all_properties","manage_properties"]},{path:"/properties/new",roles:["admin","owner"],permissions:["create_property"]},{path:"/financial",roles:["admin","owner"],permissions:["view_financials"],requiresMFA:!0},{path:"/financial/reports",roles:["admin","owner"],permissions:["generate_reports"],requiresMFA:!0},{path:"/maintenance",roles:["admin","owner","agent"],permissions:["manage_requests","view_all_requests"]},{path:"/tenants",roles:["admin","owner","agent"],permissions:["manage_tenants","view_tenant_data"]},{path:"/leases",roles:["admin","owner","agent"],permissions:["manage_leases"]},{path:"/profile",roles:["admin","owner","agent","tenant"]},{path:"/messages",roles:["admin","owner","agent","tenant"]}],a=async e=>{try{let t=n.find(t=>e.startsWith(t.path)||e===t.path);if(!t)return!0;if(t.roles&&t.roles.length>0&&!await (0,s.Ac)(t.roles))return!1;if(t.permissions&&t.permissions.length>0){if(t.requiresAll){if(!await (0,s.wP)(t.permissions))return!1}else if(!(await Promise.all(t.permissions.map(e=>(0,s.Fs)(e)))).some(Boolean))return!1}return!0}catch(e){return console.error("Error checking route access:",e),!1}},i=e=>{let t=n.find(t=>e.startsWith(t.path)||e===t.path);return(null==t?void 0:t.requiresMFA)===!0};class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}async initialize(){try{this.userRole=await (0,s.Rg)();let e=await this.getUserPermissions();this.userPermissions=e}catch(e){console.error("Error initializing permission checker:",e),this.userRole=null,this.userPermissions=[]}}async getUserPermissions(){try{let e=await Promise.all([(0,s.Fs)("read"),(0,s.Fs)("write"),(0,s.Fs)("delete"),(0,s.Fs)("approve"),(0,s.Fs)("manage_users"),(0,s.Fs)("manage_properties"),(0,s.Fs)("manage_requests"),(0,s.Fs)("manage_tenants"),(0,s.Fs)("view_financials"),(0,s.Fs)("generate_reports"),(0,s.Fs)("manage_leases"),(0,s.Fs)("view_lease"),(0,s.Fs)("system_admin"),(0,s.Fs)("audit_logs")]);return["read","write","delete","approve","manage_users","manage_properties","manage_requests","manage_tenants","view_financials","generate_reports","manage_leases","view_lease","system_admin","audit_logs"].filter((t,r)=>e[r])}catch(e){return console.error("Error getting user permissions:",e),[]}}can(e){return this.userPermissions.includes(e)}canAny(e){return e.some(e=>this.userPermissions.includes(e))}canAll(e){return e.every(e=>this.userPermissions.includes(e))}hasRole(e){return this.userRole===e}hasAnyRole(e){return!!this.userRole&&e.includes(this.userRole)}isAdmin(){return"admin"===this.userRole}isOwner(){return"owner"===this.userRole}isAgent(){return"agent"===this.userRole}isTenant(){return"tenant"===this.userRole}canManageUsers(){return this.can("manage_users")}canManageProperties(){return this.can("manage_properties")}canViewFinancials(){return this.can("view_financials")}canGenerateReports(){return this.can("generate_reports")}canManageRequests(){return this.can("manage_requests")}canManageTenants(){return this.can("manage_tenants")}canManageLeases(){return this.can("manage_leases")}canViewAuditLogs(){return this.can("audit_logs")}constructor(){this.userRole=null,this.userPermissions=[]}}o.getInstance()}}]);