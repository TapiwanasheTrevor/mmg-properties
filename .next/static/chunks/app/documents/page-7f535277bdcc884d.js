(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8479,409],{84098:function(e,a,s){Promise.resolve().then(s.bind(s,13386))},13386:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return q}});var t=s(57437),l=s(3612),c=s(99376),i=s(2265),r=s(66070),n=s(35974),d=s(62869),o=s(95186),u=s(26815),m=s(76818),h=s(53647),x=s(65613),p=s(93022),v=s(79205);let y=(0,v.Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var g=s(48736);let j=(0,v.Z)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),f=(0,v.Z)("FileVideo",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]]),N=(0,v.Z)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),w=(0,v.Z)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var b=s(66337);let k=(0,v.Z)("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Z=(0,v.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var C=s(49322),M=s(41671),z=s(91723),L=s(73247);let D=(0,v.Z)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var S=s(92369),T=s(31047),A=s(42208),_=s(92735),B=s(15868),E=s(18930),I=s(52093),O=s(10409);let R=[{value:"lease_agreement",label:"Lease Agreements",description:"Rental agreements and contracts"},{value:"tenant_application",label:"Tenant Applications",description:"Application forms and background checks"},{value:"property_documents",label:"Property Documents",description:"Deeds, titles, and property papers"},{value:"maintenance_reports",label:"Maintenance Reports",description:"Repair and maintenance documentation"},{value:"financial_records",label:"Financial Records",description:"Receipts, invoices, and financial documents"},{value:"inspection_reports",label:"Inspection Reports",description:"Property inspection and assessment reports"},{value:"legal_documents",label:"Legal Documents",description:"Legal notices, court documents, and contracts"},{value:"insurance_documents",label:"Insurance Documents",description:"Insurance policies and claims"},{value:"certificates",label:"Certificates",description:"Permits, licenses, and certificates"},{value:"photos",label:"Photos",description:"Property and unit photographs"},{value:"other",label:"Other",description:"Miscellaneous documents"}];function P(e){var a;let{relatedResource:s,category:c}=e,{user:v}=(0,l.aC)(),[P,q]=(0,i.useState)([]),[U,V]=(0,i.useState)(null),[H,Q]=(0,i.useState)(!0),[F,Y]=(0,i.useState)(!1),[J,W]=(0,i.useState)(""),[X,G]=(0,i.useState)(""),[K,$]=(0,i.useState)(""),[ee,ea]=(0,i.useState)(c||"all"),[es,et]=(0,i.useState)(null),[el,ec]=(0,i.useState)(!1),[ei,er]=(0,i.useState)(!1),[en,ed]=(0,i.useState)({files:[],name:"",description:"",category:c||"other",tags:"",accessLevel:"private"}),[eo,eu]=(0,i.useState)({name:"",description:"",category:"other",tags:"",accessLevel:"private"});(0,i.useEffect)(()=>{em(),eh()},[ee,s]);let em=async()=>{Q(!0),W("");try{let e;if(K)e=await (0,O.W7)(K,v.id,{category:"all"!==ee?ee:void 0}),q(e);else{let a=(e=await (0,O.qi)({category:"all"!==ee?ee:void 0,relatedResourceType:null==s?void 0:s.type,relatedResourceId:null==s?void 0:s.id,isActive:!0,pageSize:100})).documents.filter(e=>(0,O.Q4)(e,v.id,"view"));q(a)}}catch(e){W(e.message)}finally{Q(!1)}},eh=async()=>{try{let e=await (0,O.T8)(null==v?void 0:v.id);V(e)}catch(e){console.error("Error loading statistics:",e)}};(0,i.useEffect)(()=>{let e=setTimeout(()=>{em()},300);return()=>clearTimeout(e)},[K]);let ex=async e=>{if(e.preventDefault(),v&&0!==en.files.length){Y(!0),W("");try{let e=en.files.map(async(e,a)=>{let t=en.files.length>1?"".concat(en.name," (").concat(a+1,")"):en.name;return await (0,O.uploadDocument)(e,{name:t,description:en.description,category:en.category,tags:en.tags.split(",").map(e=>e.trim()).filter(Boolean),relatedResource:s,accessLevel:en.accessLevel},v.id,v.name,v.role)});await Promise.all(e),G("Successfully uploaded ".concat(en.files.length," document(s)!")),ec(!1),ed({files:[],name:"",description:"",category:c||"other",tags:"",accessLevel:"private"}),await em(),await eh()}catch(e){W(e.message)}finally{Y(!1)}}},ep=async e=>{if(e.preventDefault(),v&&es)try{await (0,O.gU)(es.id,{name:eo.name,description:eo.description,category:eo.category,tags:eo.tags.split(",").map(e=>e.trim()).filter(Boolean),accessLevel:eo.accessLevel},v.id,v.role),G("Document updated successfully!"),er(!1),et(null),await em()}catch(e){W(e.message)}},ev=async e=>{if(v&&confirm("Are you sure you want to delete this document?"))try{await (0,O.iH)(e.id,v.id,v.role),G("Document deleted successfully!"),await em(),await eh()}catch(e){W(e.message)}},ey=e=>{et(e),eu({name:e.name,description:e.description||"",category:e.category,tags:e.tags.join(", "),accessLevel:e.accessLevel}),er(!0)},eg=e=>e.startsWith("image/")?(0,t.jsx)(y,{className:"w-5 h-5"}):"application/pdf"===e?(0,t.jsx)(g.Z,{className:"w-5 h-5"}):e.includes("spreadsheet")||e.includes("excel")?(0,t.jsx)(j,{className:"w-5 h-5"}):e.startsWith("video/")?(0,t.jsx)(f,{className:"w-5 h-5"}):(0,t.jsx)(N,{className:"w-5 h-5"}),ej=e=>{switch(e){case"public":return(0,t.jsx)(w,{className:"w-4 h-4 text-green-600"});case"restricted":return(0,t.jsx)(b.Z,{className:"w-4 h-4 text-red-600"});default:return(0,t.jsx)(k,{className:"w-4 h-4 text-blue-600"})}},ef=e=>{if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]};return H&&0===P.length?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,t.jsx)(r.Zb,{children:(0,t.jsxs)(r.aY,{className:"pt-6",children:[(0,t.jsx)(p.O,{className:"h-8 w-16 mb-2"}),(0,t.jsx)(p.O,{className:"h-4 w-24"})]})},e))}),(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"pt-6",children:(0,t.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,t.jsx)(p.O,{className:"h-16 w-full"},e))})})})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Document Manager"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:s?"Documents for ".concat(s.name):"Manage all documents and files"})]}),(0,t.jsxs)(d.z,{onClick:()=>ec(!0),children:[(0,t.jsx)(Z,{className:"mr-2 h-4 w-4"}),"Upload Documents"]})]}),J&&(0,t.jsxs)(x.bZ,{variant:"destructive",children:[(0,t.jsx)(C.Z,{className:"h-4 w-4"}),(0,t.jsx)(x.X,{children:J})]}),X&&(0,t.jsxs)(x.bZ,{children:[(0,t.jsx)(M.Z,{className:"h-4 w-4"}),(0,t.jsx)(x.X,{children:X})]}),U&&!s&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 text-blue-600"}),(0,t.jsxs)("div",{className:"ml-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Documents"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:U.total})]})]})})}),(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(Z,{className:"h-4 w-4 text-green-600"}),(0,t.jsxs)("div",{className:"ml-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Size"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:ef(U.totalSize)})]})]})})}),(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(w,{className:"h-4 w-4 text-purple-600"}),(0,t.jsxs)("div",{className:"ml-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Public Docs"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:U.byAccessLevel.public||0})]})]})})}),(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(z.Z,{className:"h-4 w-4 text-orange-600"}),(0,t.jsxs)("div",{className:"ml-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Recent Uploads"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:U.recentUploads.length})]})]})})})]}),(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(L.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(o.I,{placeholder:"Search documents...",value:K,onChange:e=>$(e.target.value),className:"pl-8"})]})}),(0,t.jsxs)(h.Ph,{value:ee,onValueChange:ea,children:[(0,t.jsx)(h.i4,{className:"w-[200px]",children:(0,t.jsx)(h.ki,{})}),(0,t.jsxs)(h.Bw,{children:[(0,t.jsx)(h.Ql,{value:"all",children:"All Categories"}),R.map(e=>(0,t.jsx)(h.Ql,{value:e.value,children:e.label},e.value))]})]})]})})}),(0,t.jsxs)(r.Zb,{children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsxs)(r.ll,{children:["Documents (",P.length,")"]}),(0,t.jsx)(r.SZ,{children:"all"!==ee?"Showing ".concat(null===(a=R.find(e=>e.value===ee))||void 0===a?void 0:a.label," documents"):"All documents"})]}),(0,t.jsx)(r.aY,{children:0===P.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(g.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No documents found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:K?"No documents match your search criteria.":"No documents have been uploaded yet."}),(0,t.jsxs)(d.z,{onClick:()=>ec(!0),children:[(0,t.jsx)(Z,{className:"mr-2 h-4 w-4"}),"Upload First Document"]})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:P.map(e=>{var a;return(0,t.jsxs)("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[eg(e.mimeType),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h4",{className:"font-semibold text-sm truncate",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.fileName})]})]}),ej(e.accessLevel)]}),(0,t.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(n.C,{className:"text-xs",children:null===(a=R.find(a=>a.value===e.category))||void 0===a?void 0:a.label}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:ef(e.fileSize)})]}),e.tags.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.tags.slice(0,3).map((e,a)=>(0,t.jsxs)(n.C,{variant:"outline",className:"text-xs",children:[(0,t.jsx)(D,{className:"w-2 h-2 mr-1"}),e]},a)),e.tags.length>3&&(0,t.jsxs)(n.C,{variant:"outline",className:"text-xs",children:["+",e.tags.length-3," more"]})]}),e.description&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:e.description})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(S.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:e.uploadedByName})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(T.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:(0,I.WU)(e.createdAt.toDate(),"MMM dd, yyyy")})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsxs)(d.z,{variant:"outline",size:"sm",onClick:()=>window.open(e.downloadUrl,"_blank"),children:[(0,t.jsx)(A.Z,{className:"w-3 h-3 mr-1"}),"View"]}),(0,t.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>{let a=e.createElement("a");a.href=e.downloadUrl,a.download=e.fileName,a.click()},children:(0,t.jsx)(_.Z,{className:"w-3 h-3"})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,O.Q4)(e,v.id,"edit")&&(0,t.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>ey(e),children:(0,t.jsx)(B.Z,{className:"w-3 h-3"})}),(0,O.Q4)(e,v.id,"delete")&&(0,t.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>ev(e),className:"text-red-600 hover:text-red-700",children:(0,t.jsx)(E.Z,{className:"w-3 h-3"})})]})]})]},e.id)})})})]}),el&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)(r.Zb,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(r.Ol,{children:(0,t.jsx)(r.ll,{children:"Upload Documents"})}),(0,t.jsx)(r.aY,{children:(0,t.jsxs)("form",{onSubmit:ex,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Files *"}),(0,t.jsx)(o.I,{type:"file",multiple:!0,onChange:e=>{let a=Array.from(e.target.files||[]);ed(e=>({...e,files:a})),a.length>0&&!en.name&&ed(e=>({...e,name:a[0].name.replace(/\.[^/.]+$/,"")}))},accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif,.xls,.xlsx,.ppt,.pptx",required:!0}),en.files.length>0&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Selected ",en.files.length," file(s): ",en.files.map(e=>e.name).join(", ")]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Document Name *"}),(0,t.jsx)(o.I,{value:en.name,onChange:e=>ed(a=>({...a,name:e.target.value})),placeholder:"Enter document name",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Category *"}),(0,t.jsxs)(h.Ph,{value:en.category,onValueChange:e=>ed(a=>({...a,category:e})),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{})}),(0,t.jsx)(h.Bw,{children:R.map(e=>(0,t.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Access Level"}),(0,t.jsxs)(h.Ph,{value:en.accessLevel,onValueChange:e=>ed(a=>({...a,accessLevel:e})),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{})}),(0,t.jsxs)(h.Bw,{children:[(0,t.jsx)(h.Ql,{value:"private",children:"Private"}),(0,t.jsx)(h.Ql,{value:"public",children:"Public"}),(0,t.jsx)(h.Ql,{value:"restricted",children:"Restricted"})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Tags (Optional)"}),(0,t.jsx)(o.I,{value:en.tags,onChange:e=>ed(a=>({...a,tags:e.target.value})),placeholder:"Enter tags separated by commas"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Description (Optional)"}),(0,t.jsx)(m.g,{value:en.description,onChange:e=>ed(a=>({...a,description:e.target.value})),placeholder:"Enter document description",rows:3})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)(d.z,{type:"button",variant:"outline",onClick:()=>ec(!1),children:"Cancel"}),(0,t.jsx)(d.z,{type:"submit",disabled:F,children:F?"Uploading...":"Upload Documents"})]})]})})]})}),ei&&es&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)(r.Zb,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(r.Ol,{children:(0,t.jsx)(r.ll,{children:"Edit Document"})}),(0,t.jsx)(r.aY,{children:(0,t.jsxs)("form",{onSubmit:ep,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Document Name *"}),(0,t.jsx)(o.I,{value:eo.name,onChange:e=>eu(a=>({...a,name:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Category *"}),(0,t.jsxs)(h.Ph,{value:eo.category,onValueChange:e=>eu(a=>({...a,category:e})),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{})}),(0,t.jsx)(h.Bw,{children:R.map(e=>(0,t.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Access Level"}),(0,t.jsxs)(h.Ph,{value:eo.accessLevel,onValueChange:e=>eu(a=>({...a,accessLevel:e})),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{})}),(0,t.jsxs)(h.Bw,{children:[(0,t.jsx)(h.Ql,{value:"private",children:"Private"}),(0,t.jsx)(h.Ql,{value:"public",children:"Public"}),(0,t.jsx)(h.Ql,{value:"restricted",children:"Restricted"})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Tags"}),(0,t.jsx)(o.I,{value:eo.tags,onChange:e=>eu(a=>({...a,tags:e.target.value})),placeholder:"Enter tags separated by commas"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u._,{children:"Description"}),(0,t.jsx)(m.g,{value:eo.description,onChange:e=>eu(a=>({...a,description:e.target.value})),rows:3})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)(d.z,{type:"button",variant:"outline",onClick:()=>er(!1),children:"Cancel"}),(0,t.jsx)(d.z,{type:"submit",children:"Save Changes"})]})]})})]})})]})}function q(){let{user:e,loading:a}=(0,l.aC)();return a?(0,t.jsx)("div",{children:"Loading..."}):(e||(0,c.redirect)("/login"),(0,t.jsx)("div",{className:"max-w-7xl mx-auto p-6",children:(0,t.jsx)(P,{})}))}},10409:function(e,a,s){"use strict";s.d(a,{Q4:function(){return p},T8:function(){return x},W7:function(){return h},gU:function(){return u},iH:function(){return m},qi:function(){return o},uploadDocument:function(){return n}});var t=s(5978),l=s(60062),c=s(17293),i=s(51149);let r=(0,t.hJ)(c.db,"documents");(0,t.hJ)(c.db,"document_folders");let n=async(e,a,s,n,d)=>{try{var o,u,m;let h=Date.now(),x=e.name.replace(/[^a-zA-Z0-9.-]/g,"_"),p="".concat(h,"_").concat(x),v=a.folderId?"documents/".concat(a.folderId):"documents/general",y=(0,l.iH)(c.tO,"".concat(v,"/").concat(p)),g=await (0,l.KV)(y,e),j=await (0,l.Jt)(g.ref),f={name:a.name,description:a.description,fileName:e.name,fileSize:e.size,mimeType:e.type,category:a.category,tags:a.tags||[],uploadedBy:s,uploadedByName:n,uploadedByRole:d,relatedResource:a.relatedResource,accessLevel:a.accessLevel||"private",permissions:{view:(null===(o=a.permissions)||void 0===o?void 0:o.view)||[s],edit:(null===(u=a.permissions)||void 0===u?void 0:u.edit)||[s],delete:(null===(m=a.permissions)||void 0===m?void 0:m.delete)||[s]},downloadUrl:j,storageRef:g.ref.fullPath,version:1,isActive:!0,metadata:{width:void 0,height:void 0,pageCount:void 0,extractedText:void 0},createdAt:(0,t.Bt)(),updatedAt:(0,t.Bt)()},N=await (0,t.ET)(r,f);return await i.Cv.logDataExport(s,d,"document",{action:"upload",documentId:N.id,fileName:e.name,fileSize:e.size,category:a.category}),N.id}catch(e){throw console.error("Error uploading document:",e),e}},d=async e=>{try{let a=(0,t.JU)(c.db,"documents",e),s=await (0,t.QT)(a);if(s.exists())return{id:s.id,...s.data()};return null}catch(e){throw console.error("Error getting document:",e),e}},o=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let a=(0,t.IO)(r);e.category&&(a=(0,t.IO)(a,(0,t.ar)("category","==",e.category))),e.relatedResourceType&&e.relatedResourceId&&(a=(0,t.IO)(a,(0,t.ar)("relatedResource.type","==",e.relatedResourceType)),a=(0,t.IO)(a,(0,t.ar)("relatedResource.id","==",e.relatedResourceId))),e.uploadedBy&&(a=(0,t.IO)(a,(0,t.ar)("uploadedBy","==",e.uploadedBy))),e.accessLevel&&(a=(0,t.IO)(a,(0,t.ar)("accessLevel","==",e.accessLevel))),void 0!==e.isActive&&(a=(0,t.IO)(a,(0,t.ar)("isActive","==",e.isActive))),a=(0,t.IO)(a,(0,t.Xo)("createdAt","desc")),e.pageSize&&(a=(0,t.IO)(a,(0,t.b9)(e.pageSize)));let s=await (0,t.PL)(a),l=[];return s.forEach(e=>{l.push({id:e.id,...e.data()})}),{documents:l,total:l.length}}catch(e){throw console.error("Error getting documents:",e),e}},u=async(e,a,s,l)=>{try{let r=(0,t.JU)(c.db,"documents",e);await (0,t.r7)(r,{...a,updatedAt:(0,t.Bt)()}),await i.Cv.logDataExport(s,l,"document",{action:"update",documentId:e,updates:a})}catch(e){throw console.error("Error updating document:",e),e}},m=async(e,a,s)=>{try{let r=await d(e);if(!r)throw Error("Document not found");let n=(0,l.iH)(c.tO,r.storageRef);await (0,l.oq)(n);let o=(0,t.JU)(c.db,"documents",e);await (0,t.oe)(o),await i.Cv.logDataExport(a,s,"document",{action:"delete",documentId:e,fileName:r.fileName})}catch(e){throw console.error("Error deleting document:",e),e}},h=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let{documents:t}=await o({pageSize:1e3}),l=t.filter(e=>"public"===e.accessLevel||e.permissions.view.includes(a)||e.uploadedBy===a),c=e.toLowerCase();return l.filter(a=>{var t,l;let i=!e||a.name.toLowerCase().includes(c)||(null===(t=a.description)||void 0===t?void 0:t.toLowerCase().includes(c))||a.fileName.toLowerCase().includes(c)||a.tags.some(e=>e.toLowerCase().includes(c)),r=!s.category||a.category===s.category,n=!(null===(l=s.tags)||void 0===l?void 0:l.length)||s.tags.some(e=>a.tags.includes(e)),d=a.createdAt.toDate(),o=!s.dateFrom||d>=s.dateFrom,u=!s.dateTo||d<=s.dateTo;return i&&r&&n&&o&&u}).sort((e,a)=>a.createdAt.toDate().getTime()-e.createdAt.toDate().getTime())}catch(e){throw console.error("Error searching documents:",e),e}},x=async e=>{try{let{documents:a}=await o({pageSize:1e4}),s=e?a.filter(a=>a.uploadedBy===e):a,t={total:s.length,totalSize:s.reduce((e,a)=>e+a.fileSize,0),byCategory:{},byAccessLevel:{},byMimeType:{},recentUploads:s.sort((e,a)=>a.createdAt.toDate().getTime()-e.createdAt.toDate().getTime()).slice(0,10),largestFiles:s.sort((e,a)=>a.fileSize-e.fileSize).slice(0,10)};return s.forEach(e=>{t.byCategory[e.category]=(t.byCategory[e.category]||0)+1,t.byAccessLevel[e.accessLevel]=(t.byAccessLevel[e.accessLevel]||0)+1,t.byMimeType[e.mimeType]=(t.byMimeType[e.mimeType]||0)+1}),t}catch(e){throw console.error("Error getting document statistics:",e),e}},p=(e,a,s)=>{var t;return e.uploadedBy===a||"view"===s&&"public"===e.accessLevel||(null===(t=e.permissions[s])||void 0===t?void 0:t.includes(a))||!1}},31047:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},41671:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},91723:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},92735:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},48736:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},66337:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},73247:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},15868:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},18930:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},92369:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},6394:function(e,a,s){"use strict";s.d(a,{f:function(){return r}});var t=s(2265),l=s(66840),c=s(57437),i=t.forwardRef((e,a)=>(0,c.jsx)(l.WV.label,{...e,ref:a,onMouseDown:a=>{var s;a.target.closest("button, input, select, textarea")||(null===(s=e.onMouseDown)||void 0===s||s.call(e,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));i.displayName="Label";var r=i}},function(e){e.O(0,[4358,139,92,5189,7746,3825,2093,4193,9984,6729,2971,2117,1744],function(){return e(e.s=84098)}),_N_E=e.O()}]);