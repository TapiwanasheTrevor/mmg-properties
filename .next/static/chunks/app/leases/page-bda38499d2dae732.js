(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9232],{36562:function(e,s,a){Promise.resolve().then(a.bind(a,66925))},66925:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return E}});var t=a(57437),r=a(73044),l=a(2265),n=a(27648),i=a(3612),c=a(66070),d=a(35974),h=a(62869),x=a(95186),o=a(53647),m=a(65613),u=a(93022),j=a(99397),f=a(49322),g=a(73247),p=a(48736),N=a(67782),v=a(42208),y=a(15868),w=a(18930),b=a(95805),Z=a(14938),k=a(95252),O=a(31047),I=a(84190),C=a(52093),M=a(63921);function z(e){let{onLeaseSelect:s}=e,{user:a}=(0,i.aC)(),[r,z]=(0,l.useState)([]),[E,A]=(0,l.useState)(!0),[D,S]=(0,l.useState)(""),[L,_]=(0,l.useState)(""),[H,Q]=(0,l.useState)("all");(0,l.useEffect)(()=>{q()},[a,H]);let q=async()=>{if(a){A(!0),S("");try{let e={};"all"!==H&&(e.status=H);let s=await (0,M.rV)(e);z(s.leases)}catch(e){S(e.message)}finally{A(!1)}}},T=async e=>{if(confirm("Are you sure you want to delete this lease? This action cannot be undone."))try{await (0,M.fj)(e),z(s=>s.filter(s=>s.id!==e))}catch(e){S(e.message)}},U=r.filter(e=>{if(!L)return!0;let s=L.toLowerCase();return e.tenantId.toLowerCase().includes(s)||e.unitId.toLowerCase().includes(s)}),X=e=>({draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",notice_given:"bg-yellow-100 text-yellow-800",expired:"bg-red-100 text-red-800",terminated:"bg-red-100 text-red-800"})[e],V=e=>({draft:"Draft",active:"Active",notice_given:"Notice Given",expired:"Expired",terminated:"Terminated"})[e];return E&&0===r.length?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.O,{className:"h-8 w-48"}),(0,t.jsx)(u.O,{className:"h-4 w-64 mt-2"})]}),(0,t.jsx)(u.O,{className:"h-10 w-32"})]}),(0,t.jsx)(c.Zb,{children:(0,t.jsx)(c.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(u.O,{className:"h-10 flex-1"}),(0,t.jsx)(u.O,{className:"h-10 w-32"}),(0,t.jsx)(u.O,{className:"h-10 w-32"})]})})}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(u.O,{className:"h-5 w-32"}),(0,t.jsx)(u.O,{className:"h-6 w-16"})]})}),(0,t.jsx)(c.aY,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(u.O,{className:"h-4 w-full"}),(0,t.jsx)(u.O,{className:"h-4 w-full"}),(0,t.jsx)(u.O,{className:"h-8 w-full"})]})})]},e))})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Lease Agreements"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Manage lease agreements and tenant relationships (",r.length," leases)"]})]}),((null==a?void 0:a.role)==="admin"||(null==a?void 0:a.role)==="agent")&&(0,t.jsx)(h.z,{asChild:!0,children:(0,t.jsxs)(n.default,{href:"/leases/new",children:[(0,t.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"New Lease"]})})]}),D&&(0,t.jsxs)(m.bZ,{variant:"destructive",children:[(0,t.jsx)(f.Z,{className:"h-4 w-4"}),(0,t.jsx)(m.X,{children:D})]}),(0,t.jsx)(c.Zb,{children:(0,t.jsx)(c.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(g.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(x.I,{placeholder:"Search by tenant or unit...",className:"pl-8",value:L,onChange:e=>_(e.target.value)})]})}),(0,t.jsxs)(o.Ph,{value:H,onValueChange:e=>Q(e),children:[(0,t.jsx)(o.i4,{className:"w-[180px]",children:(0,t.jsx)(o.ki,{placeholder:"Status"})}),(0,t.jsxs)(o.Bw,{children:[(0,t.jsx)(o.Ql,{value:"all",children:"All Status"}),(0,t.jsx)(o.Ql,{value:"draft",children:"Draft"}),(0,t.jsx)(o.Ql,{value:"active",children:"Active"}),(0,t.jsx)(o.Ql,{value:"notice_given",children:"Notice Given"}),(0,t.jsx)(o.Ql,{value:"expired",children:"Expired"}),(0,t.jsx)(o.Ql,{value:"terminated",children:"Terminated"})]})]})]})})}),0!==U.length||E?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:U.map(e=>(0,t.jsxs)(c.Zb,{className:"hover:shadow-lg transition-shadow",children:[(0,t.jsx)(c.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium",children:"Lease Agreement"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["ID: ",e.id.slice(0,8),"..."]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.C,{className:X(e.status),children:V(e.status)}),(0,t.jsxs)(I.h_,{children:[(0,t.jsx)(I.$F,{asChild:!0,children:(0,t.jsx)(h.z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,t.jsx)(N.Z,{className:"h-4 w-4"})})}),(0,t.jsxs)(I.AW,{align:"end",children:[(0,t.jsx)(I.Xi,{asChild:!0,children:(0,t.jsxs)(n.default,{href:"/leases/".concat(e.id),children:[(0,t.jsx)(v.Z,{className:"mr-2 h-4 w-4"}),"View Details"]})}),((null==a?void 0:a.role)==="admin"||(null==a?void 0:a.role)==="agent")&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.Xi,{asChild:!0,children:(0,t.jsxs)(n.default,{href:"/leases/".concat(e.id,"/edit"),children:[(0,t.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"Edit"]})}),(0,t.jsxs)(I.Xi,{onClick:()=>T(e.id),className:"text-red-600",children:[(0,t.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]})]})}),(0,t.jsx)(c.aY,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,t.jsx)(b.Z,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,t.jsxs)("span",{children:["Tenant: ",e.tenantId.slice(0,8),"..."]})]}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,t.jsx)(Z.Z,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,t.jsxs)("span",{children:["Unit: ",e.unitId.slice(0,8),"..."]})]}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,t.jsx)(k.Z,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,t.jsxs)("span",{children:[e.terms.currency," ",e.terms.rentAmount.toLocaleString(),"/",e.terms.paymentFrequency]})]}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,t.jsx)(O.Z,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,t.jsxs)("span",{children:[(0,C.WU)(e.dates.startDate.toDate(),"MMM dd, yyyy")," - ",(0,C.WU)(e.dates.endDate.toDate(),"MMM dd, yyyy")]})]}),(0,t.jsxs)("div",{className:"flex justify-between pt-3 border-t",children:[(0,t.jsxs)(h.z,{variant:"outline",size:"sm",onClick:()=>null==s?void 0:s(e.id),children:[(0,t.jsx)(v.Z,{className:"w-3 h-3 mr-1"}),"View"]}),(0,t.jsx)("div",{className:"space-x-2",children:"active"===e.status&&(0,t.jsx)(h.z,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsxs)(n.default,{href:"/leases/".concat(e.id,"/renew"),children:[(0,t.jsx)(O.Z,{className:"w-3 h-3 mr-1"}),"Renew"]})})})]})]})})]},e.id))}):(0,t.jsx)(c.Zb,{children:(0,t.jsxs)(c.aY,{className:"pt-6 text-center",children:[(0,t.jsx)(p.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No leases found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:L?"No leases match your search criteria.":"Get started by creating your first lease agreement."}),((null==a?void 0:a.role)==="admin"||(null==a?void 0:a.role)==="agent")&&!L&&(0,t.jsx)(h.z,{asChild:!0,children:(0,t.jsxs)(n.default,{href:"/leases/new",children:[(0,t.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"New Lease"]})})]})}),E&&r.length>0&&(0,t.jsx)("div",{className:"text-center py-4",children:(0,t.jsxs)("div",{className:"inline-flex items-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Loading more leases..."]})})]})}function E(){return(0,t.jsx)(r.Z,{allowedRoles:["admin","agent","owner"],children:(0,t.jsx)(z,{})})}},48984:function(e,s,a){"use strict";a.d(s,{E2:function(){return n},lK:function(){return c},vw:function(){return i},zI:function(){return d}});var t=a(5978);a(60062);var r=a(17293);let l=(0,t.hJ)(r.db,"properties"),n=async e=>{try{let s=(0,t.JU)(r.db,"properties",e);await (0,t.oe)(s)}catch(e){throw console.error("Error deleting property:",e),e}},i=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let s=(0,t.IO)(l);e.ownerId&&(s=(0,t.IO)(s,(0,t.ar)("ownerId","==",e.ownerId))),e.assignedAgentId&&(s=(0,t.IO)(s,(0,t.ar)("assignedAgents","array-contains",e.assignedAgentId))),e.type&&(s=(0,t.IO)(s,(0,t.ar)("type","==",e.type))),e.status&&(s=(0,t.IO)(s,(0,t.ar)("status","==",e.status))),s=(0,t.IO)(s,(0,t.Xo)("createdAt","desc")),e.pageSize&&(s=(0,t.IO)(s,(0,t.b9)(e.pageSize))),e.lastDoc&&(s=(0,t.IO)(s,(0,t.TQ)(e.lastDoc)));let a=await (0,t.PL)(s),r=[];return a.forEach(e=>{r.push({id:e.id,...e.data()})}),{properties:r,lastDoc:a.docs[a.docs.length-1],hasMore:a.docs.length===(e.pageSize||0)}}catch(e){throw console.error("Error getting properties:",e),e}},c=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let a=(0,t.IO)(l,(0,t.ar)("name",">=",e),(0,t.ar)("name","<=",e+"ï£¿"),(0,t.Xo)("name"),s(s)),r=await (0,t.PL)(a),n=[];return r.forEach(e=>{n.push({id:e.id,...e.data()})}),n}catch(e){throw console.error("Error searching properties:",e),e}},d=async(e,s,a)=>{try{let l=(0,t.JU)(r.db,"properties",e);await (0,t.r7)(l,{totalUnits:s,occupiedUnits:a,updatedAt:(0,t.Bt)()})}catch(e){throw console.error("Error updating property occupancy:",e),e}}},95252:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(79205).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},48736:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(79205).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},95805:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(79205).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[4358,139,92,5189,7746,3825,2093,4193,2972,3774,9984,2982,3921,3940,2971,2117,1744],function(){return e(e.s=36562)}),_N_E=e.O()}]);