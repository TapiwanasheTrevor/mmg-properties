(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4109],{44014:function(e,t,s){Promise.resolve().then(s.bind(s,67014))},67014:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eB}});var a=s(57437),n=s(2265),r=s(3612),l=s(99376),i=s(12339),c=s(66070),d=s(35974),o=s(60044),x=s(95252),m=s(95805),h=s(29525),u=s(48736),j=s(42488),p=s(46221),g=s(72007),f=s(48664),y=s(62869),N=s(65613),v=s(93022),b=s(49322),w=s(92735),R=s(82431),Z=s(14938),D=s(70525),S=s(3085),C=s(47625),O=s(77031),T=s(56940),M=s(97059),P=s(62994),k=s(8147),I=s(31699),A=s(90377),E=s(20407),q=s(5978),Y=s(17293);let _=async e=>{try{let t=(0,q.IO)((0,q.hJ)(Y.db,"properties"));e&&(t=(0,q.IO)(t,(0,q.ar)("id","==",e)));let s=await (0,q.PL)(t),a=[];for(let e of s.docs){let t={id:e.id,...e.data()},s=(0,q.IO)((0,q.hJ)(Y.db,"units"),(0,q.ar)("propertyId","==",t.id)),n=(await (0,q.PL)(s)).docs.map(e=>({id:e.id,...e.data()})),r=(0,q.IO)((0,q.hJ)(Y.db,"leases"),(0,q.ar)("propertyId","==",t.id),(0,q.ar)("status","==","active")),l=(await (0,q.PL)(r)).docs.map(e=>({id:e.id,...e.data()})),i=new Date;i.setMonth(i.getMonth()-12);let c=(0,q.IO)((0,q.hJ)(Y.db,"transactions"),(0,q.ar)("propertyId","==",t.id),(0,q.ar)("date",">=",q.EK.fromDate(i))),d=(await (0,q.PL)(c)).docs.map(e=>({id:e.id,...e.data()})),o=(0,q.IO)((0,q.hJ)(Y.db,"maintenance_requests"),(0,q.ar)("propertyId","==",t.id)),x=(await (0,q.PL)(o)).docs.map(e=>({id:e.id,...e.data()})),m=n.length,h=l.length,u=m-h,j=m>0?h/m*100:0,p=l.reduce((e,t)=>{var s;return e+((null===(s=t.terms)||void 0===s?void 0:s.rentAmount)||0)},0),g=h>0?p/h:0,f=d.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),y=d.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0),N=f-y,v=f>0?N/f*100:0,b=d.filter(e=>"maintenance"===e.category).reduce((e,t)=>e+t.amount,0),w=l.length>0?12:0;a.push({propertyId:t.id,propertyName:t.name,totalUnits:m,occupiedUnits:h,vacantUnits:u,occupancyRate:j,totalRentRoll:p,averageRent:g,totalRevenue:f,totalExpenses:y,netIncome:N,roi:v,maintenanceCosts:b,maintenanceRequests:x.length,averageTenantStay:w,renewalRate:85,lastUpdated:new Date})}return a}catch(e){throw console.error("Error getting property analytics:",e),e}},F=async e=>{try{let t=(null==e?void 0:e.start)||(()=>{let e=new Date;return e.setMonth(e.getMonth()-12),e})(),s=(null==e?void 0:e.end)||new Date,a=(0,q.IO)((0,q.hJ)(Y.db,"transactions"),(0,q.ar)("date",">=",q.EK.fromDate(t)),(0,q.ar)("date","<=",q.EK.fromDate(s)),(0,q.Xo)("date","desc")),n=(await (0,q.PL)(a)).docs.map(e=>({id:e.id,...e.data(),date:e.data().date.toDate()})),r=n.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),l=n.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0),i=r-l,c=Math.abs(s.getTime()-t.getTime()),d=new Date(t.getTime()-c),o=new Date(t.getTime()),x=(0,q.IO)((0,q.hJ)(Y.db,"transactions"),(0,q.ar)("date",">=",q.EK.fromDate(d)),(0,q.ar)("date","<=",q.EK.fromDate(o))),m=(await (0,q.PL)(x)).docs.map(e=>({id:e.id,...e.data()})),h=m.filter(e=>"income"===e.type).reduce((e,t)=>e+t.amount,0),u=m.filter(e=>"expense"===e.type).reduce((e,t)=>e+t.amount,0),j=new Map;n.forEach(e=>{let t=e.date.toISOString().substring(0,7);j.has(t)||j.set(t,{revenue:0,expenses:0,netIncome:0,occupancyRate:0});let s=j.get(t);"income"===e.type?s.revenue+=e.amount:"expense"===e.type&&(s.expenses+=e.amount),s.netIncome=s.revenue-s.expenses});let p=Array.from(j.entries()).sort((e,t)=>{let[s]=e,[a]=t;return s.localeCompare(a)}).map(e=>{let[t,s]=e;return{month:t,...s}}),g=n.filter(e=>"income"===e.type&&"rent"===e.category),f=g.reduce((e,t)=>e+t.amount,0),y=g.length>0?f/g.length:0,N=.05*r;return{totalRevenue:r,totalExpenses:l,netIncome:i,grossMargin:r>0?(r-l)/r*100:0,operatingExpenseRatio:r>0?l/r*100:0,revenueGrowth:h>0?(r-h)/h*100:0,expenseGrowth:u>0?(l-u)/u*100:0,profitMargin:r>0?i/r*100:0,averageRentCollection:y,outstandingRent:N,collectionRate:r>0?(r-N)/r*100:0,monthlyBreakdown:p}}catch(e){throw console.error("Error getting financial metrics:",e),e}},U=async()=>{try{let e=(0,q.IO)((0,q.hJ)(Y.db,"tenants")),t=(await (0,q.PL)(e)).docs.map(e=>({id:e.id,...e.data()})),s=(0,q.IO)((0,q.hJ)(Y.db,"leases"),(0,q.ar)("status","==","active")),a=(await (0,q.PL)(s)).docs.map(e=>({id:e.id,...e.data()})),n=new Date;n.setMonth(n.getMonth()-12);let r=(0,q.IO)((0,q.hJ)(Y.db,"leases"),(0,q.ar)("dates.startDate",">=",q.EK.fromDate(n))),l=(await (0,q.PL)(r)).docs.map(e=>({id:e.id,...e.data()})),i=(0,q.IO)((0,q.hJ)(Y.db,"maintenance_requests")),c=(await (0,q.PL)(i)).docs.map(e=>({id:e.id,...e.data()})),d=t.length,o=a.length,x=l.filter(e=>{var t,s;let a=null===(s=e.dates)||void 0===s?void 0:null===(t=s.startDate)||void 0===t?void 0:t.toDate();return a&&a>=n}).length,m=a.filter(e=>"completed"===e.status),h=m.length>0?m.reduce((e,t)=>{var s,a,n,r;let l=null===(a=t.dates)||void 0===a?void 0:null===(s=a.startDate)||void 0===s?void 0:s.toDate(),i=null===(r=t.dates)||void 0===r?void 0:null===(n=r.endDate)||void 0===n?void 0:n.toDate();return l&&i?e+Math.abs(i.getTime()-l.getTime())/2592e6:e},0)/m.length:12,u=a.length>0?a.reduce((e,t)=>{var s;return e+((null===(s=t.terms)||void 0===s?void 0:s.rentAmount)||0)},0)/a.length:0,j=o>0?c.length/o:0;return{totalTenants:d,activeTenants:o,newTenants:x,departedTenants:5,averageTenantStay:h,renewalRate:85,earlyTerminationRate:10,averageRent:u,onTimePaymentRate:92,maintenanceRequestsPerTenant:j,tenantSatisfactionScore:4.2,demographicBreakdown:{ageGroups:{"18-25":Math.floor(.15*d),"26-35":Math.floor(.35*d),"36-45":Math.floor(.25*d),"46-55":Math.floor(.15*d),"55+":Math.floor(.1*d)},tenancyDuration:{"0-6 months":Math.floor(.2*d),"6-12 months":Math.floor(.25*d),"1-2 years":Math.floor(.3*d),"2-3 years":Math.floor(.15*d),"3+ years":Math.floor(.1*d)},unitTypes:{studio:Math.floor(.15*d),"1_bedroom":Math.floor(.35*d),"2_bedroom":Math.floor(.3*d),"3_bedroom":Math.floor(.15*d),"4_bedroom":Math.floor(.05*d)}}}}catch(e){throw console.error("Error getting tenant analytics:",e),e}},z=async()=>{try{let e=(0,q.IO)((0,q.hJ)(Y.db,"maintenance_requests")),t=(await (0,q.PL)(e)).docs.map(e=>{var t,s;return{id:e.id,...e.data(),createdAt:null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate(),completedAt:null===(s=e.data().completedAt)||void 0===s?void 0:s.toDate()}}),s=(0,q.IO)((0,q.hJ)(Y.db,"transactions"),(0,q.ar)("category","==","maintenance"),(0,q.ar)("type","==","expense")),a=(await (0,q.PL)(s)).docs.map(e=>{var t;return{id:e.id,...e.data(),date:null===(t=e.data().date)||void 0===t?void 0:t.toDate()}}),n=t.length,r=t.filter(e=>"completed"===e.status).length,l=t.filter(e=>["pending","in_progress"].includes(e.status)).length,i=t.filter(e=>"completed"===e.status&&e.createdAt&&e.completedAt),c=i.length>0?i.reduce((e,t)=>{let s=(t.completedAt.getTime()-t.createdAt.getTime())/864e5;return e+s},0)/i.length:0,d=a.reduce((e,t)=>e+t.amount,0),o={};t.forEach(e=>{let t=e.category||"other";o[t]=(o[t]||0)+1});let x={};t.forEach(e=>{let t=e.priority||"medium";x[t]=(x[t]||0)+1});let m={};a.forEach(e=>{let t=e.subcategory||e.description||"other";m[t]=(m[t]||0)+e.amount});let h=[],u=new Date;for(let e=11;e>=0;e--){let s=new Date(u.getFullYear(),u.getMonth()-e,1).toISOString().substring(0,7),n=t.filter(e=>e.createdAt&&e.createdAt.toISOString().substring(0,7)===s),r=a.filter(e=>e.date&&e.date.toISOString().substring(0,7)===s),l=n.filter(e=>"completed"===e.status&&e.completedAt),i=l.length>0?l.reduce((e,t)=>{let s=(t.completedAt.getTime()-t.createdAt.getTime())/864e5;return e+s},0)/l.length:0;h.push({month:s,requests:n.length,costs:r.reduce((e,t)=>e+t.amount,0),averageResolutionTime:i})}let j=Object.entries(o).map(e=>{let[t,s]=e;return{category:t,count:s,averageCost:m[t]?m[t]/s:0}}).sort((e,t)=>t.count-e.count).slice(0,5);return{totalRequests:n,completedRequests:r,pendingRequests:l,averageResolutionTime:c,totalCosts:d,averageCostPerRequest:n>0?d/n:0,requestsByCategory:o,requestsByPriority:x,costsByCategory:m,monthlyTrends:h,topIssues:j}}catch(e){throw console.error("Error getting maintenance analytics:",e),e}},B=async()=>{try{let e=(0,q.IO)((0,q.hJ)(Y.db,"leases")),t=(await (0,q.PL)(e)).docs.map(e=>{var t,s,a,n;return{id:e.id,...e.data(),startDate:null===(s=e.data().dates)||void 0===s?void 0:null===(t=s.startDate)||void 0===t?void 0:t.toDate(),endDate:null===(n=e.data().dates)||void 0===n?void 0:null===(a=n.endDate)||void 0===a?void 0:a.toDate()}}),s=new Date,a=new Date(s.getTime()+2592e6),n=new Date(s.getTime()+5184e6),r=new Date(s.getTime()+7776e6),l=t.length,i=t.filter(e=>"active"===e.status).length,c=t.filter(e=>e.endDate&&e.endDate<=a&&e.endDate>s).length,d=t.filter(e=>e.endDate&&e.endDate<=n&&e.endDate>a).length,o=t.filter(e=>e.endDate&&e.endDate<=r&&e.endDate>n).length,x=Math.floor(.7*l),m=t.filter(e=>e.startDate&&e.endDate),h=m.length>0?m.reduce((e,t)=>{let s=(t.endDate.getTime()-t.startDate.getTime())/2592e6;return e+s},0)/m.length:12,u={};t.forEach(e=>{let t=e.type||"standard";u[t]=(u[t]||0)+1});let j=[];for(let e=0;e<12;e++){let a=new Date(s.getFullYear(),s.getMonth()+e,1),n=new Date(s.getFullYear(),s.getMonth()+e+1,1),r=a.toISOString().substring(0,7),l=t.filter(e=>e.endDate&&e.endDate>=a&&e.endDate<n).length,i=Math.floor(.7*l),c=l-i;j.push({month:r,expiringCount:l,renewalCount:i,terminationCount:c})}return{totalLeases:l,activeLeases:i,expiring30Days:c,expiring60Days:d,expiring90Days:o,renewedLeases:x,terminatedLeases:Math.floor(.3*l),averageLeaseDuration:h,renewalRate:l>0?x/l*100:0,earlyTerminationRate:15,leaseTypeBreakdown:u,monthlyExpirations:j}}catch(e){throw console.error("Error getting lease analytics:",e),e}},K=async()=>{try{let[e,t]=await Promise.all([_(),F()]),s=e.length,a=e.reduce((e,t)=>e+t.totalUnits,0),n=e.reduce((e,t)=>e+t.occupiedUnits,0),r=e.reduce((e,t)=>e+t.totalRentRoll,0),l=t.totalExpenses/12,i=r-l,c=[...e].sort((e,t)=>t.roi-e.roi),d=c.slice(0,3),o=c.slice(-3).reverse();return{totalProperties:s,totalUnits:a,occupiedUnits:n,overallOccupancyRate:a>0?n/a*100:0,totalPortfolioValue:1e7,totalMonthlyRevenue:r,totalMonthlyExpenses:l,netOperatingIncome:i,portfolioROI:12*i/1e7*100,propertyPerformance:e,topPerformingProperties:d,underperformingProperties:o}}catch(e){throw console.error("Error getting portfolio overview:",e),e}},G=(e,t)=>{if(0===e.length)return;let s=Object.keys(e[0]),a=new Blob([[s.join(","),...e.map(e=>s.map(t=>{let s=e[t];return"string"==typeof s&&s.includes(",")?'"'.concat(s,'"'):s}).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");if(void 0!==n.download){let e=URL.createObjectURL(a);n.setAttribute("href",e),n.setAttribute("download","".concat(t,".csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}};function L(){let[e,t]=(0,n.useState)(null),[s,r]=(0,n.useState)(!0),[l,i]=(0,n.useState)(!1),[m,h]=(0,n.useState)("");(0,n.useEffect)(()=>{u()},[]);let u=async()=>{r(!0),h("");try{let e=await K();t(e)}catch(e){h(e.message)}finally{r(!1)}},g=async()=>{i(!0),await u(),i(!1)},q=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),Y=e=>"".concat(e.toFixed(1),"%"),_=e=>e>=15?"text-green-600":e>=10?"text-blue-600":e>=5?"text-yellow-600":"text-red-600",F=e=>e>=95?"bg-green-100 text-green-800":e>=85?"bg-blue-100 text-blue-800":e>=75?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",U=["#2563eb","#7c3aed","#dc2626","#ea580c","#65a30d","#0891b2"];if(s)return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(v.O,{className:"h-8 w-64"}),(0,a.jsx)(v.O,{className:"h-10 w-32"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,a.jsx)(v.O,{className:"h-32"},e))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(v.O,{className:"h-80"}),(0,a.jsx)(v.O,{className:"h-80"})]})]});if(m)return(0,a.jsxs)(N.bZ,{variant:"destructive",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4"}),(0,a.jsx)(N.X,{children:m})]});if(!e)return(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(o.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Portfolio Data"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No portfolio data available to display."})]});let z=e.propertyPerformance.map(e=>({name:e.propertyName.substring(0,15)+(e.propertyName.length>15?"...":""),occupancy:e.occupancyRate,roi:e.roi,netIncome:e.netIncome,revenue:e.totalRevenue})),B=[{name:"90-100%",value:e.propertyPerformance.filter(e=>e.occupancyRate>=90).length},{name:"80-89%",value:e.propertyPerformance.filter(e=>e.occupancyRate>=80&&e.occupancyRate<90).length},{name:"70-79%",value:e.propertyPerformance.filter(e=>e.occupancyRate>=70&&e.occupancyRate<80).length},{name:"60-69%",value:e.propertyPerformance.filter(e=>e.occupancyRate>=60&&e.occupancyRate<70).length},{name:"<60%",value:e.propertyPerformance.filter(e=>e.occupancyRate<60).length}].filter(e=>e.value>0);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Portfolio Overview"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Comprehensive view of your property portfolio performance"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(y.z,{variant:"outline",onClick:()=>{e&&G(e.propertyPerformance.map(e=>({"Property Name":e.propertyName,"Total Units":e.totalUnits,"Occupied Units":e.occupiedUnits,"Occupancy Rate (%)":e.occupancyRate.toFixed(2),"Monthly Rent Roll":e.totalRentRoll,"Average Rent":e.averageRent,"Total Revenue":e.totalRevenue,"Total Expenses":e.totalExpenses,"Net Income":e.netIncome,"ROI (%)":e.roi.toFixed(2),"Maintenance Costs":e.maintenanceCosts,"Maintenance Requests":e.maintenanceRequests})),"portfolio-overview")},children:[(0,a.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),"Export Data"]}),(0,a.jsxs)(y.z,{onClick:g,disabled:l,children:[(0,a.jsx)(R.Z,{className:"mr-2 h-4 w-4 ".concat(l?"animate-spin":"")}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Properties"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:e.totalProperties})]}),(0,a.jsx)(o.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Portfolio Value"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:q(e.totalPortfolioValue)})]}),(0,a.jsx)(x.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Occupancy Rate"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:Y(e.overallOccupancyRate)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.occupiedUnits," of ",e.totalUnits," units"]})]}),(0,a.jsx)(Z.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Portfolio ROI"}),(0,a.jsx)("p",{className:"text-2xl font-bold ".concat(_(e.portfolioROI)),children:Y(e.portfolioROI)})]}),(0,a.jsx)(D.Z,{className:"h-8 w-8 text-muted-foreground"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Monthly Revenue"}),(0,a.jsx)("p",{className:"text-xl font-bold text-green-600",children:q(e.totalMonthlyRevenue)})]}),(0,a.jsx)(D.Z,{className:"h-6 w-6 text-green-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Monthly Expenses"}),(0,a.jsx)("p",{className:"text-xl font-bold text-red-600",children:q(e.totalMonthlyExpenses)})]}),(0,a.jsx)(S.Z,{className:"h-6 w-6 text-red-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Net Operating Income"}),(0,a.jsx)("p",{className:"text-xl font-bold ".concat(e.netOperatingIncome>=0?"text-green-600":"text-red-600"),children:q(e.netOperatingIncome)})]}),(0,a.jsx)(j.Z,{className:"h-6 w-6 text-muted-foreground"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"mr-2 h-5 w-5"}),"Property Performance"]}),(0,a.jsx)(c.SZ,{children:"Occupancy rate and ROI by property"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(O.v,{data:z,children:[(0,a.jsx)(T.q,{strokeDasharray:"3 3"}),(0,a.jsx)(M.K,{dataKey:"name",fontSize:12,angle:-45,textAnchor:"end",height:60}),(0,a.jsx)(P.B,{fontSize:12}),(0,a.jsx)(k.u,{formatter:(e,t)=>"occupancy"===t||"roi"===t?["".concat(e,"%"),"occupancy"===t?"Occupancy Rate":"ROI"]:[q(e),"netIncome"===t?"Net Income":"Revenue"]}),(0,a.jsx)(I.$,{dataKey:"occupancy",fill:"#2563eb",name:"occupancy"}),(0,a.jsx)(I.$,{dataKey:"roi",fill:"#7c3aed",name:"roi"})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-5 w-5"}),"Occupancy Distribution"]}),(0,a.jsx)(c.SZ,{children:"Properties by occupancy rate ranges"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(A.u,{children:[(0,a.jsx)(Pie,{dataKey:"value",data:B,cx:"50%",cy:"50%",outerRadius:80,label:e=>{let{name:t,value:s}=e;return"".concat(t,": ").concat(s)},children:B.map((e,t)=>(0,a.jsx)(E.b,{fill:U[t%U.length]},"cell-".concat(t)))}),(0,a.jsx)(k.u,{})]})})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center text-green-600",children:[(0,a.jsx)(D.Z,{className:"mr-2 h-5 w-5"}),"Top Performing Properties"]}),(0,a.jsx)(c.SZ,{children:"Properties with highest ROI"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:e.topPerformingProperties.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"font-semibold text-green-700",children:["#",t+1]}),(0,a.jsx)("h4",{className:"font-medium",children:e.propertyName})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.occupiedUnits,"/",e.totalUnits," units occupied"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-bold text-green-600",children:Y(e.roi)}),(0,a.jsxs)(d.C,{className:F(e.occupancyRate),children:[Y(e.occupancyRate)," occupied"]})]})]},e.propertyId))})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center text-orange-600",children:[(0,a.jsx)(S.Z,{className:"mr-2 h-5 w-5"}),"Properties Needing Attention"]}),(0,a.jsx)(c.SZ,{children:"Properties with lower performance metrics"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:e.underperformingProperties.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 bg-orange-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 text-orange-500"}),(0,a.jsx)("h4",{className:"font-medium",children:e.propertyName})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.occupiedUnits,"/",e.totalUnits," units occupied"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-bold text-orange-600",children:Y(e.roi)}),(0,a.jsxs)(d.C,{className:F(e.occupancyRate),children:[Y(e.occupancyRate)," occupied"]})]})]},e.propertyId))})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{children:"Property Performance Details"}),(0,a.jsx)(c.SZ,{children:"Detailed performance metrics for all properties"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full table-auto",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left p-2",children:"Property"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Units"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Occupancy"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Rent Roll"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Revenue"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Expenses"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Net Income"}),(0,a.jsx)("th",{className:"text-right p-2",children:"ROI"})]})}),(0,a.jsx)("tbody",{children:e.propertyPerformance.map(e=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"p-2",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.propertyName}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.maintenanceRequests," maintenance requests"]})]})}),(0,a.jsxs)("td",{className:"text-right p-2",children:[e.occupiedUnits,"/",e.totalUnits]}),(0,a.jsx)("td",{className:"text-right p-2",children:(0,a.jsx)(d.C,{className:F(e.occupancyRate),children:Y(e.occupancyRate)})}),(0,a.jsx)("td",{className:"text-right p-2",children:q(e.totalRentRoll)}),(0,a.jsx)("td",{className:"text-right p-2",children:q(e.totalRevenue)}),(0,a.jsx)("td",{className:"text-right p-2",children:q(e.totalExpenses)}),(0,a.jsx)("td",{className:"text-right p-2",children:(0,a.jsx)("span",{className:e.netIncome>=0?"text-green-600":"text-red-600",children:q(e.netIncome)})}),(0,a.jsx)("td",{className:"text-right p-2",children:(0,a.jsx)("span",{className:_(e.roi),children:Y(e.roi)})})]},e.propertyId))})]})})})]})]})}var Q=s(53647),V=s(88226),J=s(91804),$=s(58896),H=s(5019),X=s(23263),W=s(54061);function ee(){let[e,t]=(0,n.useState)(null),[s,r]=(0,n.useState)(!0),[l,i]=(0,n.useState)(!1),[o,m]=(0,n.useState)(""),[h,u]=(0,n.useState)("12_months");(0,n.useEffect)(()=>{q()},[h]);let Z=()=>{let e=new Date,t=new Date;switch(h){case"3_months":t.setMonth(t.getMonth()-3);break;case"6_months":t.setMonth(t.getMonth()-6);break;case"12_months":default:t.setMonth(t.getMonth()-12);break;case"24_months":t.setMonth(t.getMonth()-24)}return{start:t,end:e}},q=async()=>{r(!0),m("");try{let e=await F(Z());t(e)}catch(e){m(e.message)}finally{r(!1)}},Y=async()=>{i(!0),await q(),i(!1)},_=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),U=e=>"".concat(e.toFixed(1),"%"),z=e=>e>0?"text-green-600":e<0?"text-red-600":"text-gray-600",B=e=>e>0?D.Z:e<0?S.Z:j.Z;if(s)return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(v.O,{className:"h-8 w-64"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(v.O,{className:"h-10 w-32"}),(0,a.jsx)(v.O,{className:"h-10 w-32"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,a.jsx)(v.O,{className:"h-32"},e))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(v.O,{className:"h-80"}),(0,a.jsx)(v.O,{className:"h-80"})]})]});if(o)return(0,a.jsxs)(N.bZ,{variant:"destructive",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4"}),(0,a.jsx)(N.X,{children:o})]});if(!e)return(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(x.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Financial Data"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No financial data available for the selected period."})]});let K=e.monthlyBreakdown.map(e=>({...e,month:new Date(e.month+"-01").toLocaleDateString("en-US",{month:"short",year:"2-digit"}),profitMargin:e.revenue>0?e.netIncome/e.revenue*100:0})),L=[{name:"Revenue",value:e.totalRevenue,color:"#2563eb"},{name:"Expenses",value:e.totalExpenses,color:"#dc2626"}],ee=[{name:"Gross Margin",value:e.grossMargin},{name:"Profit Margin",value:e.profitMargin},{name:"Operating Expense Ratio",value:e.operatingExpenseRatio}];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Financial Dashboard"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Comprehensive financial performance metrics and trends"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(Q.Ph,{value:h,onValueChange:u,children:[(0,a.jsx)(Q.i4,{className:"w-32",children:(0,a.jsx)(Q.ki,{})}),(0,a.jsxs)(Q.Bw,{children:[(0,a.jsx)(Q.Ql,{value:"3_months",children:"3 Months"}),(0,a.jsx)(Q.Ql,{value:"6_months",children:"6 Months"}),(0,a.jsx)(Q.Ql,{value:"12_months",children:"12 Months"}),(0,a.jsx)(Q.Ql,{value:"24_months",children:"24 Months"})]})]}),(0,a.jsxs)(y.z,{variant:"outline",onClick:()=>{e&&G([{Metric:"Total Revenue",Amount:e.totalRevenue,Growth:e.revenueGrowth},{Metric:"Total Expenses",Amount:e.totalExpenses,Growth:e.expenseGrowth},{Metric:"Net Income",Amount:e.netIncome,Growth:0},{Metric:"Gross Margin",Amount:e.grossMargin,Growth:0},{Metric:"Operating Expense Ratio",Amount:e.operatingExpenseRatio,Growth:0},{Metric:"Collection Rate",Amount:e.collectionRate,Growth:0}],"financial-metrics")},children:[(0,a.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),"Export"]}),(0,a.jsxs)(y.z,{onClick:Y,disabled:l,children:[(0,a.jsx)(R.Z,{className:"mr-2 h-4 w-4 ".concat(l?"animate-spin":"")}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Revenue"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:_(e.totalRevenue)}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[React.createElement(B(e.revenueGrowth),{className:"h-3 w-3 mr-1 ".concat(z(e.revenueGrowth))}),(0,a.jsxs)("span",{className:"text-xs ".concat(z(e.revenueGrowth)),children:[U(Math.abs(e.revenueGrowth))," vs prev period"]})]})]}),(0,a.jsx)(x.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Expenses"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:_(e.totalExpenses)}),(0,a.jsxs)("div",{className:"flex items-center mt-1",children:[React.createElement(B(e.expenseGrowth),{className:"h-3 w-3 mr-1 ".concat(z(e.expenseGrowth))}),(0,a.jsxs)("span",{className:"text-xs ".concat(z(e.expenseGrowth)),children:[U(Math.abs(e.expenseGrowth))," vs prev period"]})]})]}),(0,a.jsx)(V.Z,{className:"h-8 w-8 text-red-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Net Income"}),(0,a.jsx)("p",{className:"text-2xl font-bold ".concat(e.netIncome>=0?"text-green-600":"text-red-600"),children:_(e.netIncome)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[U(e.profitMargin)," profit margin"]})]}),(0,a.jsx)(J.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Collection Rate"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:U(e.collectionRate)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[_(e.outstandingRent)," outstanding"]})]}),(0,a.jsx)($.Z,{className:"h-8 w-8 text-muted-foreground"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Gross Margin"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:U(e.grossMargin)})]}),(0,a.jsx)(d.C,{variant:e.grossMargin>=70?"default":e.grossMargin>=50?"secondary":"destructive",children:e.grossMargin>=70?"Excellent":e.grossMargin>=50?"Good":"Needs Attention"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Operating Expense Ratio"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:U(e.operatingExpenseRatio)})]}),(0,a.jsx)(d.C,{variant:e.operatingExpenseRatio<=30?"default":e.operatingExpenseRatio<=50?"secondary":"destructive",children:e.operatingExpenseRatio<=30?"Excellent":e.operatingExpenseRatio<=50?"Good":"High"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg Rent Collection"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:_(e.averageRentCollection)})]}),(0,a.jsx)(j.Z,{className:"h-6 w-6 text-muted-foreground"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(g.Z,{className:"mr-2 h-5 w-5"}),"Revenue & Expenses Trend"]}),(0,a.jsx)(c.SZ,{children:"Monthly financial performance over time"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(H.c,{data:K,children:[(0,a.jsx)(T.q,{strokeDasharray:"3 3"}),(0,a.jsx)(M.K,{dataKey:"month",fontSize:12}),(0,a.jsx)(P.B,{yAxisId:"left",fontSize:12,tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,a.jsx)(P.B,{yAxisId:"right",orientation:"right",fontSize:12,tickFormatter:e=>"".concat(e,"%")}),(0,a.jsx)(k.u,{formatter:(e,t)=>"profitMargin"===t?["".concat(e,"%"),"Profit Margin"]:[_(e),"revenue"===t?"Revenue":"expenses"===t?"Expenses":"Net Income"]}),(0,a.jsx)(X.u,{yAxisId:"left",type:"monotone",dataKey:"revenue",stackId:"1",stroke:"#2563eb",fill:"#2563eb",fillOpacity:.6,name:"revenue"}),(0,a.jsx)(X.u,{yAxisId:"left",type:"monotone",dataKey:"expenses",stackId:"2",stroke:"#dc2626",fill:"#dc2626",fillOpacity:.6,name:"expenses"}),(0,a.jsx)(W.x,{yAxisId:"right",type:"monotone",dataKey:"profitMargin",stroke:"#7c3aed",strokeWidth:2,dot:{r:4},name:"profitMargin"})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-5 w-5"}),"Revenue vs Expenses"]}),(0,a.jsx)(c.SZ,{children:"Total financial breakdown for selected period"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(A.u,{children:[(0,a.jsx)(Pie,{dataKey:"value",data:L,cx:"50%",cy:"50%",outerRadius:80,label:e=>{let{name:t,value:s}=e;return"".concat(t,": ").concat(_(s))},children:L.map((e,t)=>(0,a.jsx)(E.b,{fill:e.color},"cell-".concat(t)))}),(0,a.jsx)(k.u,{formatter:e=>_(e)})]})}),(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsxs)("p",{className:"text-lg font-semibold",children:["Net Income:",(0,a.jsx)("span",{className:"ml-2 ".concat(e.netIncome>=0?"text-green-600":"text-red-600"),children:_(e.netIncome)})]})})]})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"mr-2 h-5 w-5"}),"Financial Ratios"]}),(0,a.jsx)(c.SZ,{children:"Key financial performance indicators"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(O.v,{data:ee,children:[(0,a.jsx)(T.q,{strokeDasharray:"3 3"}),(0,a.jsx)(M.K,{dataKey:"name",fontSize:12}),(0,a.jsx)(P.B,{fontSize:12,tickFormatter:e=>"".concat(e,"%")}),(0,a.jsx)(k.u,{formatter:e=>["".concat(e,"%"),"Percentage"]}),(0,a.jsx)(I.$,{dataKey:"value",fill:"#2563eb"})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{children:"Monthly Financial Breakdown"}),(0,a.jsx)(c.SZ,{children:"Detailed monthly performance metrics"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full table-auto",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left p-2",children:"Month"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Revenue"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Expenses"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Net Income"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Profit Margin"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Occupancy"})]})}),(0,a.jsx)("tbody",{children:K.map(e=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"p-2 font-medium",children:e.month}),(0,a.jsx)("td",{className:"text-right p-2 text-green-600",children:_(e.revenue)}),(0,a.jsx)("td",{className:"text-right p-2 text-red-600",children:_(e.expenses)}),(0,a.jsx)("td",{className:"text-right p-2",children:(0,a.jsx)("span",{className:e.netIncome>=0?"text-green-600":"text-red-600",children:_(e.netIncome)})}),(0,a.jsx)("td",{className:"text-right p-2",children:U(e.profitMargin)}),(0,a.jsx)("td",{className:"text-right p-2",children:U(e.occupancyRate)})]},e.month))})]})})})]})]})}var et=s(37806),es=s(91723),ea=s(86595),en=s(88997),er=s(31047),el=s(89388),ei=s(64823),ec=s(21156),ed=s(5481);function eo(){let e;let[t,s]=(0,n.useState)(null),[r,l]=(0,n.useState)(null),[i,o]=(0,n.useState)(!0),[u,g]=(0,n.useState)(!1),[S,q]=(0,n.useState)("");(0,n.useEffect)(()=>{Y()},[]);let Y=async()=>{o(!0),q("");try{let[e,t]=await Promise.all([U(),B()]);s(e),l(t)}catch(e){q(e.message)}finally{o(!1)}},_=async()=>{g(!0),await Y(),g(!1)},F=e=>"".concat(e.toFixed(1),"%"),z=(e,t)=>e>=t.good?"text-green-600":e>=t.warning?"text-yellow-600":"text-red-600",K=(e,t)=>e>=t.good?"default":e>=t.warning?"secondary":"destructive",L=["#2563eb","#7c3aed","#dc2626","#ea580c","#65a30d","#0891b2","#8b5cf6","#f59e0b"];if(i)return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(v.O,{className:"h-8 w-64"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(v.O,{className:"h-10 w-32"}),(0,a.jsx)(v.O,{className:"h-10 w-32"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,a.jsx)(v.O,{className:"h-32"},e))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(v.O,{className:"h-80"}),(0,a.jsx)(v.O,{className:"h-80"})]})]});if(S)return(0,a.jsxs)(N.bZ,{variant:"destructive",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4"}),(0,a.jsx)(N.X,{children:S})]});if(!t||!r)return(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(m.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Tenant Data"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No tenant analytics data available to display."})]});let Q=Object.entries(t.demographicBreakdown.ageGroups).map(e=>{let[t,s]=e;return{name:t,value:s}}),V=Object.entries(t.demographicBreakdown.tenancyDuration).map(e=>{let[t,s]=e;return{name:t,value:s}}),J=Object.entries(t.demographicBreakdown.unitTypes).map(e=>{let[t,s]=e;return{name:t.replace("_"," "),value:s}}),$=r.monthlyExpirations.slice(0,6).map(e=>({month:new Date(e.month+"-01").toLocaleDateString("en-US",{month:"short"}),expiring:e.expiringCount,renewals:e.renewalCount,terminations:e.terminationCount})),H=[{name:"Tenant Satisfaction",value:t.tenantSatisfactionScore,fill:"#2563eb"}],W=[{name:"On-time Payments",value:t.onTimePaymentRate,fill:"#10b981"},{name:"Late Payments",value:100-t.onTimePaymentRate,fill:"#ef4444"}];return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Tenant & Lease Analytics"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Comprehensive tenant performance and lease management insights"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(y.z,{variant:"outline",onClick:()=>{t&&r&&G([{Metric:"Total Tenants",Value:t.totalTenants,Type:"Count"},{Metric:"Active Tenants",Value:t.activeTenants,Type:"Count"},{Metric:"New Tenants",Value:t.newTenants,Type:"Count"},{Metric:"Average Tenant Stay (months)",Value:t.averageTenantStay,Type:"Duration"},{Metric:"Renewal Rate (%)",Value:t.renewalRate,Type:"Percentage"},{Metric:"Average Rent",Value:t.averageRent,Type:"Currency"},{Metric:"On-time Payment Rate (%)",Value:t.onTimePaymentRate,Type:"Percentage"},{Metric:"Tenant Satisfaction Score",Value:t.tenantSatisfactionScore,Type:"Rating"}],"tenant-analytics")},children:[(0,a.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),"Export Data"]}),(0,a.jsxs)(y.z,{onClick:_,disabled:u,children:[(0,a.jsx)(R.Z,{className:"mr-2 h-4 w-4 ".concat(u?"animate-spin":"")}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Tenants"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:t.totalTenants}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[t.activeTenants," active"]})]}),(0,a.jsx)(m.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"New Tenants"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:t.newTenants}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[t.departedTenants," departed"]})]}),(0,a.jsx)(et.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg Tenant Stay"}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[t.averageTenantStay.toFixed(1)," months"]}),(0,a.jsx)(d.C,{variant:K(t.averageTenantStay,{good:18,warning:12}),children:t.averageTenantStay>=18?"Excellent":t.averageTenantStay>=12?"Good":"Needs Attention"})]}),(0,a.jsx)(es.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Satisfaction Score"}),(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[t.tenantSatisfactionScore.toFixed(1),"/5.0"]}),(0,a.jsx)("div",{className:"flex items-center mt-1",children:[1,2,3,4,5].map(e=>(0,a.jsx)(ea.Z,{className:"h-3 w-3 ".concat(e<=t.tenantSatisfactionScore?"text-yellow-400 fill-current":"text-gray-300")},e))})]}),(0,a.jsx)(en.Z,{className:"h-8 w-8 text-red-500"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Average Rent"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:(e=t.averageRent,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e))})]}),(0,a.jsx)(x.Z,{className:"h-6 w-6 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"On-time Payment Rate"}),(0,a.jsx)("p",{className:"text-xl font-bold ".concat(z(t.onTimePaymentRate,{good:95,warning:85})),children:F(t.onTimePaymentRate)})]}),(0,a.jsx)(d.C,{variant:K(t.onTimePaymentRate,{good:95,warning:85}),children:t.onTimePaymentRate>=95?"Excellent":t.onTimePaymentRate>=85?"Good":"Needs Attention"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Maintenance Requests"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:t.maintenanceRequestsPerTenant.toFixed(1)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"per tenant"})]}),(0,a.jsx)(h.Z,{className:"h-6 w-6 text-muted-foreground"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Leases"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:r.activeLeases}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["of ",r.totalLeases," total"]})]}),(0,a.jsx)(Z.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Renewal Rate"}),(0,a.jsx)("p",{className:"text-2xl font-bold ".concat(z(t.renewalRate,{good:80,warning:70})),children:F(t.renewalRate)}),(0,a.jsx)(d.C,{variant:K(t.renewalRate,{good:80,warning:70}),children:t.renewalRate>=80?"Excellent":t.renewalRate>=70?"Good":"Needs Attention"})]}),(0,a.jsx)(D.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Expiring Soon"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:r.expiring30Days}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"next 30 days"})]}),(0,a.jsx)(er.Z,{className:"h-8 w-8 text-orange-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg Lease Duration"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:r.averageLeaseDuration.toFixed(1)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"months"})]}),(0,a.jsx)(j.Z,{className:"h-8 w-8 text-muted-foreground"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-5 w-5"}),"Tenant Age Groups"]}),(0,a.jsx)(c.SZ,{children:"Distribution of tenants by age range"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(A.u,{children:[(0,a.jsx)(Pie,{dataKey:"value",data:Q,cx:"50%",cy:"50%",outerRadius:80,label:e=>{let{name:t,value:s}=e;return"".concat(t,": ").concat(s)},children:Q.map((e,t)=>(0,a.jsx)(E.b,{fill:L[t%L.length]},"cell-".concat(t)))}),(0,a.jsx)(k.u,{})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"mr-2 h-5 w-5"}),"Tenancy Duration"]}),(0,a.jsx)(c.SZ,{children:"How long tenants have been staying"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(O.v,{data:V,children:[(0,a.jsx)(T.q,{strokeDasharray:"3 3"}),(0,a.jsx)(M.K,{dataKey:"name",fontSize:12}),(0,a.jsx)(P.B,{fontSize:12}),(0,a.jsx)(k.u,{}),(0,a.jsx)(I.$,{dataKey:"value",fill:"#2563eb"})]})})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-5 w-5"}),"Payment Performance"]}),(0,a.jsx)(c.SZ,{children:"On-time vs late payment distribution"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(A.u,{children:[(0,a.jsx)(Pie,{dataKey:"value",data:W,cx:"50%",cy:"50%",outerRadius:80,label:e=>{let{name:t,value:s}=e;return"".concat(t,": ").concat(s.toFixed(1),"%")},children:W.map((e,t)=>(0,a.jsx)(E.b,{fill:e.fill},"cell-".concat(t)))}),(0,a.jsx)(k.u,{formatter:e=>"".concat(e,"%")})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(ea.Z,{className:"mr-2 h-5 w-5"}),"Tenant Satisfaction"]}),(0,a.jsx)(c.SZ,{children:"Overall satisfaction rating out of 5.0"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(el.B,{cx:"50%",cy:"50%",innerRadius:"60%",outerRadius:"90%",data:H,children:[(0,a.jsx)(ei.G,{dataKey:"value",cornerRadius:10,fill:"#2563eb",max:5}),(0,a.jsxs)("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",className:"text-2xl font-bold",children:[t.tenantSatisfactionScore.toFixed(1),"/5.0"]})]})})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(ec.w,{className:"mr-2 h-5 w-5"}),"Lease Expiration Trends"]}),(0,a.jsx)(c.SZ,{children:"Upcoming lease expirations and expected outcomes"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(ed.T,{data:$,children:[(0,a.jsx)(T.q,{strokeDasharray:"3 3"}),(0,a.jsx)(M.K,{dataKey:"month",fontSize:12}),(0,a.jsx)(P.B,{fontSize:12}),(0,a.jsx)(k.u,{}),(0,a.jsx)(X.u,{type:"monotone",dataKey:"expiring",stackId:"1",stroke:"#fbbf24",fill:"#fbbf24",fillOpacity:.6,name:"Expiring"}),(0,a.jsx)(X.u,{type:"monotone",dataKey:"renewals",stackId:"2",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Expected Renewals"}),(0,a.jsx)(X.u,{type:"monotone",dataKey:"terminations",stackId:"3",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6,name:"Expected Terminations"})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(Z.Z,{className:"mr-2 h-5 w-5"}),"Unit Type Distribution"]}),(0,a.jsx)(c.SZ,{children:"Tenant distribution across different unit types"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(O.v,{data:J,layout:"horizontal",children:[(0,a.jsx)(T.q,{strokeDasharray:"3 3"}),(0,a.jsx)(M.K,{type:"number",fontSize:12}),(0,a.jsx)(P.B,{dataKey:"name",type:"category",fontSize:12,width:80}),(0,a.jsx)(k.u,{}),(0,a.jsx)(I.$,{dataKey:"value",fill:"#7c3aed"})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{children:"Upcoming Lease Expirations"}),(0,a.jsx)(c.SZ,{children:"Schedule of leases expiring in the next 90 days"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Next 30 Days"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:r.expiring30Days}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"leases expiring"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"31-60 Days"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:r.expiring60Days}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"leases expiring"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"61-90 Days"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:r.expiring90Days}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"leases expiring"})]})]}),(0,a.jsx)("div",{className:"mt-4 p-4 bg-green-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-green-800",children:"Renewal Performance"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[r.renewedLeases," renewals vs ",r.terminatedLeases," terminations"]})]}),(0,a.jsxs)(d.C,{variant:"default",className:"bg-green-600",children:[F(r.renewalRate)," renewal rate"]})]})})]})]})]})}var ex=s(41671),em=s(76865);function eh(){var e;let[t,s]=(0,n.useState)(null),[r,l]=(0,n.useState)(!0),[i,o]=(0,n.useState)(!1),[m,u]=(0,n.useState)(""),[j,Z]=(0,n.useState)("12_months");(0,n.useEffect)(()=>{D()},[j]);let D=async()=>{l(!0),u("");try{let e=await z();s(e)}catch(e){u(e.message)}finally{l(!1)}},S=async()=>{o(!0),await D(),o(!1)},q=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),Y=e=>"".concat(e.toFixed(1)," days"),_=(e,t)=>"resolution"===t?e<=3?"text-green-600":e<=7?"text-yellow-600":"text-red-600":e>=90?"text-green-600":e>=75?"text-yellow-600":"text-red-600",F=["#2563eb","#7c3aed","#dc2626","#ea580c","#65a30d","#0891b2","#8b5cf6","#f59e0b"];if(r)return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(v.O,{className:"h-8 w-64"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(v.O,{className:"h-10 w-32"}),(0,a.jsx)(v.O,{className:"h-10 w-32"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,a.jsx)(v.O,{className:"h-32"},e))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(v.O,{className:"h-80"}),(0,a.jsx)(v.O,{className:"h-80"})]})]});if(m)return(0,a.jsxs)(N.bZ,{variant:"destructive",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4"}),(0,a.jsx)(N.X,{children:m})]});if(!t)return(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(h.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Maintenance Data"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No maintenance analytics data available to display."})]});let U=Object.entries(t.requestsByCategory).map(e=>{let[s,a]=e;return{name:s.replace("_"," ").toUpperCase(),requests:a,costs:t.costsByCategory[s]||0}}),B=Object.entries(t.requestsByPriority).map(e=>{let[t,s]=e;return{name:t.toUpperCase(),value:s}}),K=t.monthlyTrends.map(e=>({month:new Date(e.month+"-01").toLocaleDateString("en-US",{month:"short",year:"2-digit"}),requests:e.requests,costs:e.costs,avgResolution:e.averageResolutionTime})),L=Object.entries(t.costsByCategory).map(e=>{let[t,s]=e;return{name:t.replace("_"," ").toUpperCase(),value:s}}),V=t&&0!==t.totalRequests?t.completedRequests/t.totalRequests*100:0;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Maintenance Analytics"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Comprehensive maintenance cost analysis and performance trends"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(Q.Ph,{value:j,onValueChange:Z,children:[(0,a.jsx)(Q.i4,{className:"w-32",children:(0,a.jsx)(Q.ki,{})}),(0,a.jsxs)(Q.Bw,{children:[(0,a.jsx)(Q.Ql,{value:"6_months",children:"6 Months"}),(0,a.jsx)(Q.Ql,{value:"12_months",children:"12 Months"}),(0,a.jsx)(Q.Ql,{value:"24_months",children:"24 Months"})]})]}),(0,a.jsxs)(y.z,{variant:"outline",onClick:()=>{t&&G([{Metric:"Total Requests",Value:t.totalRequests,Type:"Count"},{Metric:"Completed Requests",Value:t.completedRequests,Type:"Count"},{Metric:"Pending Requests",Value:t.pendingRequests,Type:"Count"},{Metric:"Average Resolution Time (days)",Value:t.averageResolutionTime,Type:"Duration"},{Metric:"Total Costs",Value:t.totalCosts,Type:"Currency"},{Metric:"Average Cost Per Request",Value:t.averageCostPerRequest,Type:"Currency"}],"maintenance-analytics")},children:[(0,a.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),"Export"]}),(0,a.jsxs)(y.z,{onClick:S,disabled:i,children:[(0,a.jsx)(R.Z,{className:"mr-2 h-4 w-4 ".concat(i?"animate-spin":"")}),"Refresh"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Requests"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:t.totalRequests}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[t.completedRequests," completed"]})]}),(0,a.jsx)(h.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg Resolution Time"}),(0,a.jsx)("p",{className:"text-2xl font-bold ".concat(_(t.averageResolutionTime,"resolution")),children:Y(t.averageResolutionTime)}),(0,a.jsx)(d.C,{variant:(e=t.averageResolutionTime)<=3?"default":e<=7?"secondary":"destructive",children:t.averageResolutionTime<=3?"Excellent":t.averageResolutionTime<=7?"Good":"Needs Attention"})]}),(0,a.jsx)(es.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Costs"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:q(t.totalCosts)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[q(t.averageCostPerRequest)," avg per request"]})]}),(0,a.jsx)(x.Z,{className:"h-8 w-8 text-red-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Completion Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold ".concat(_(V,"completion")),children:[V.toFixed(1),"%"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[t.pendingRequests," pending"]})]}),(0,a.jsx)($.Z,{className:"h-8 w-8 text-muted-foreground"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Completed"}),(0,a.jsx)("p",{className:"text-xl font-bold text-green-600",children:t.completedRequests})]}),(0,a.jsx)(ex.Z,{className:"h-6 w-6 text-green-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Pending"}),(0,a.jsx)("p",{className:"text-xl font-bold text-orange-600",children:t.pendingRequests})]}),(0,a.jsx)(es.Z,{className:"h-6 w-6 text-orange-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"High Priority"}),(0,a.jsx)("p",{className:"text-xl font-bold text-red-600",children:(t.requestsByPriority.urgent||0)+(t.requestsByPriority.high||0)})]}),(0,a.jsx)(em.Z,{className:"h-6 w-6 text-red-500"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(g.Z,{className:"mr-2 h-5 w-5"}),"Monthly Maintenance Trends"]}),(0,a.jsx)(c.SZ,{children:"Requests and costs over time"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(H.c,{data:K,children:[(0,a.jsx)(T.q,{strokeDasharray:"3 3"}),(0,a.jsx)(M.K,{dataKey:"month",fontSize:12}),(0,a.jsx)(P.B,{yAxisId:"left",fontSize:12}),(0,a.jsx)(P.B,{yAxisId:"right",orientation:"right",fontSize:12,tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,a.jsx)(k.u,{formatter:(e,t)=>"costs"===t?[q(e),"Costs"]:"avgResolution"===t?[Y(e),"Avg Resolution"]:[e,"Requests"]}),(0,a.jsx)(I.$,{yAxisId:"left",dataKey:"requests",fill:"#2563eb",name:"requests"}),(0,a.jsx)(X.u,{yAxisId:"right",type:"monotone",dataKey:"costs",stroke:"#dc2626",fill:"#dc2626",fillOpacity:.3,name:"costs"}),(0,a.jsx)(W.x,{yAxisId:"left",type:"monotone",dataKey:"avgResolution",stroke:"#7c3aed",strokeWidth:2,dot:{r:4},name:"avgResolution"})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-5 w-5"}),"Requests by Priority"]}),(0,a.jsx)(c.SZ,{children:"Distribution of maintenance requests by priority level"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(A.u,{children:[(0,a.jsx)(Pie,{dataKey:"value",data:B,cx:"50%",cy:"50%",outerRadius:80,label:e=>{let{name:t,value:s}=e;return"".concat(t,": ").concat(s)},children:B.map((e,t)=>(0,a.jsx)(E.b,{fill:F[t%F.length]},"cell-".concat(t)))}),(0,a.jsx)(k.u,{})]})})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"mr-2 h-5 w-5"}),"Requests by Category"]}),(0,a.jsx)(c.SZ,{children:"Maintenance requests and costs by category"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(O.v,{data:U,children:[(0,a.jsx)(T.q,{strokeDasharray:"3 3"}),(0,a.jsx)(M.K,{dataKey:"name",fontSize:12,angle:-45,textAnchor:"end",height:80}),(0,a.jsx)(P.B,{yAxisId:"left",fontSize:12}),(0,a.jsx)(P.B,{yAxisId:"right",orientation:"right",fontSize:12,tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,a.jsx)(k.u,{formatter:(e,t)=>"costs"===t?[q(e),"Total Costs"]:[e,"Requests"]}),(0,a.jsx)(I.$,{yAxisId:"left",dataKey:"requests",fill:"#2563eb",name:"requests"}),(0,a.jsx)(I.$,{yAxisId:"right",dataKey:"costs",fill:"#dc2626",name:"costs"})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-5 w-5"}),"Cost Distribution"]}),(0,a.jsx)(c.SZ,{children:"Maintenance costs breakdown by category"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(C.h,{width:"100%",height:300,children:(0,a.jsxs)(A.u,{children:[(0,a.jsx)(Pie,{dataKey:"value",data:L,cx:"50%",cy:"50%",outerRadius:80,label:e=>{let{name:t,value:s}=e;return"".concat(t,": ").concat(q(s))},children:L.map((e,t)=>(0,a.jsx)(E.b,{fill:F[t%F.length]},"cell-".concat(t)))}),(0,a.jsx)(k.u,{formatter:e=>q(e)})]})})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-5 w-5"}),"Top Maintenance Issues"]}),(0,a.jsx)(c.SZ,{children:"Most frequent maintenance categories and their costs"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:t.topIssues.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-600 rounded-full text-sm font-bold",children:t+1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:e.category.replace("_"," ").toUpperCase()}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.count," requests  ",q(e.averageCost)," average cost"]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-bold text-red-600",children:q(e.averageCost*e.count)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"total cost"})]})]},e.category))})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{children:"Monthly Performance Breakdown"}),(0,a.jsx)(c.SZ,{children:"Detailed monthly maintenance metrics"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full table-auto",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left p-2",children:"Month"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Requests"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Total Costs"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Avg Cost/Request"}),(0,a.jsx)("th",{className:"text-right p-2",children:"Avg Resolution"})]})}),(0,a.jsx)("tbody",{children:K.map(e=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"p-2 font-medium",children:e.month}),(0,a.jsx)("td",{className:"text-right p-2",children:e.requests}),(0,a.jsx)("td",{className:"text-right p-2 text-red-600",children:q(e.costs)}),(0,a.jsx)("td",{className:"text-right p-2",children:e.requests>0?q(e.costs/e.requests):"-"}),(0,a.jsx)("td",{className:"text-right p-2",children:(0,a.jsx)("span",{className:_(e.avgResolution,"resolution"),children:Y(e.avgResolution)})})]},e.month))})]})})})]})]})}var eu=s(95186),ej=s(26815),ep=s(76818),eg=s(99397),ef=s(89227),ey=s(33276),eN=s(15868),ev=s(18930),eb=s(42208),ew=s(52093),eR=s(51149);let eZ=(0,q.hJ)(Y.db,"scheduled_reports"),eD=(0,q.hJ)(Y.db,"generated_reports"),eS=async(e,t,s)=>{try{let a=eE(e.frequency,e.schedule),n={...e,nextRun:q.EK.fromDate(a),createdBy:t,createdByName:s,createdAt:(0,q.Bt)(),updatedAt:(0,q.Bt)()},r=await (0,q.ET)(eZ,n);return await eR.Cv.logDataExport(t,"","scheduled_report",{action:"create",reportId:r.id,reportName:e.name,frequency:e.frequency}),r.id}catch(e){throw console.error("Error creating scheduled report:",e),e}},eC=async e=>{try{let t=(0,q.IO)(eZ,(0,q.Xo)("createdAt","desc"));e&&(t=(0,q.IO)(t,(0,q.ar)("createdBy","==",e)));let s=await (0,q.PL)(t),a=[];return s.forEach(e=>{a.push({id:e.id,...e.data()})}),a}catch(e){throw console.error("Error getting scheduled reports:",e),e}},eO=async(e,t,s)=>{try{let a=(0,q.JU)(Y.db,"scheduled_reports",e);if(t.frequency||t.schedule){let e=await (0,q.QT)(a);if(e.exists()){let s=e.data(),a=t.frequency||s.frequency,n=t.schedule||s.schedule;t.nextRun=q.EK.fromDate(eE(a,n))}}await (0,q.r7)(a,{...t,updatedAt:(0,q.Bt)()}),await eR.Cv.logDataExport(s,"","scheduled_report",{action:"update",reportId:e,updates:t})}catch(e){throw console.error("Error updating scheduled report:",e),e}},eT=async(e,t)=>{try{let s=(0,q.JU)(Y.db,"scheduled_reports",e);await (0,q.oe)(s),await eR.Cv.logDataExport(t,"","scheduled_report",{action:"delete",reportId:e})}catch(e){throw console.error("Error deleting scheduled report:",e),e}},eM=async(e,t,s,a)=>{try{let n=Date.now(),r={name:t.name,reportType:e,generatedAt:(0,q.Bt)(),generatedBy:s,generatedByName:a,dateRange:t.dateRange,data:{summary:{},details:{}},fileUrls:{},recipients:t.recipients||[],status:"generating",metadata:{recordCount:0,fileSize:0,processingTime:0}},l=await (0,q.ET)(eD,r);try{let a={};switch(e){case"portfolio":a=await K();break;case"financial":a=await F(t.dateRange);break;case"tenant":a=await U();break;case"maintenance":a=await z();break;case"comprehensive":a=await eP(t.dateRange)}let r=ek(a,e,t),i={};("csv"===t.format||"both"===t.format)&&(i.csv=await eI(r,e)),("pdf"===t.format||"both"===t.format)&&(i.pdf=await eA(r,e,t.includeCharts));let c=Date.now()-n;return await (0,q.r7)(l,{data:r,fileUrls:i,status:"completed",metadata:{recordCount:eY(r),fileSize:await e_(i),processingTime:c},updatedAt:(0,q.Bt)()}),t.recipients&&t.recipients.length>0&&(await eq(l.id,t.recipients),await (0,q.r7)(l,{status:"sent"})),await eR.Cv.logDataExport(s,"","generated_report",{action:"generate",reportId:l.id,reportType:e,recordCount:eY(r),processingTime:c}),l.id}catch(e){throw await (0,q.r7)(l,{status:"failed",errorMessage:e instanceof Error?e.message:"Unknown error",updatedAt:(0,q.Bt)()}),e}}catch(e){throw console.error("Error generating report:",e),e}},eP=async e=>{let[t,s,a,n]=await Promise.all([K(),F(e),U(),z()]);return{portfolio:t,financial:s,tenant:a,maintenance:n,summary:{totalProperties:t.totalProperties,totalUnits:t.totalUnits,occupancyRate:t.overallOccupancyRate,totalRevenue:s.totalRevenue,netIncome:s.netIncome,activeTenants:a.activeTenants,maintenanceRequests:n.totalRequests,generatedAt:new Date().toISOString()}}},ek=(e,t,s)=>{let a={},n={};switch(t){case"portfolio":a.totalProperties=e.totalProperties,a.overallOccupancyRate=e.overallOccupancyRate,a.portfolioROI=e.portfolioROI,a.netOperatingIncome=e.netOperatingIncome,n.propertyPerformance=e.propertyPerformance;break;case"financial":a.totalRevenue=e.totalRevenue,a.totalExpenses=e.totalExpenses,a.netIncome=e.netIncome,a.profitMargin=e.profitMargin,n.monthlyBreakdown=e.monthlyBreakdown;break;case"tenant":a.totalTenants=e.totalTenants,a.renewalRate=e.renewalRate,a.averageTenantStay=e.averageTenantStay,a.tenantSatisfactionScore=e.tenantSatisfactionScore,n.demographicBreakdown=e.demographicBreakdown;break;case"maintenance":a.totalRequests=e.totalRequests,a.averageResolutionTime=e.averageResolutionTime,a.totalCosts=e.totalCosts,a.completionRate=e.completedRequests/e.totalRequests*100,n.requestsByCategory=e.requestsByCategory,n.monthlyTrends=e.monthlyTrends;break;case"comprehensive":Object.assign(a,e.summary),Object.assign(n,{portfolio:e.portfolio,financial:e.financial,tenant:e.tenant,maintenance:e.maintenance})}return{summary:a,details:n}},eI=async(e,t)=>"csv_".concat(t,"_").concat(Date.now()),eA=async(e,t,s)=>"pdf_".concat(t,"_").concat(Date.now()),eE=(e,t)=>{let s=new Date,a=new Date;switch(e){case"daily":a.setDate(s.getDate()+1);break;case"weekly":let n=(t.dayOfWeek-s.getDay()+7)%7;a.setDate(s.getDate()+(0===n?7:n));break;case"monthly":a.setMonth(s.getMonth()+1),a.setDate(t.dayOfMonth),a<s&&a.setMonth(a.getMonth()+1);break;case"quarterly":a.setMonth(s.getMonth()+3),a.setDate(t.dayOfMonth||1)}let[r,l]=t.time.split(":");return a.setHours(parseInt(r),parseInt(l),0,0),a},eq=async(e,t)=>{for(let s of(console.log("Sending report ".concat(e," to recipients:"),t),t))try{console.log("Report sent to: ".concat(s))}catch(e){console.error("Failed to send report to ".concat(s,":"),e)}},eY=e=>{let t=0;return e.details&&Object.values(e.details).forEach(e=>{Array.isArray(e)?t+=e.length:"object"==typeof e&&null!==e&&(t+=Object.keys(e).length)}),t},e_=async e=>Math.floor(1e6*Math.random())+1e5,eF=async(e,t,s)=>{try{let a=(0,q.IO)(eD,(0,q.Xo)("generatedAt","desc"));e&&(a=(0,q.IO)(a,(0,q.ar)("generatedBy","==",e))),t&&(a=(0,q.IO)(a,(0,q.ar)("reportType","==",t))),s&&(a=(0,q.IO)(a,s(s)));let n=await (0,q.PL)(a),r=[];return n.forEach(e=>{r.push({id:e.id,...e.data()})}),r}catch(e){throw console.error("Error getting generated reports:",e),e}},eU=async e=>{try{let[t,s]=await Promise.all([eC(e),eF(e,void 0,100)]);return{totalScheduled:t.length,activeScheduled:t.filter(e=>e.isActive).length,totalGenerated:s.length,recentlyGenerated:s.filter(e=>{let t=new Date;return t.setDate(t.getDate()-1),e.generatedAt.toDate()>t}).length,byType:s.reduce((e,t)=>(e[t.reportType]=(e[t.reportType]||0)+1,e),{}),byStatus:s.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{})}}catch(e){throw console.error("Error getting report statistics:",e),e}};function ez(){var e;let{user:t}=(0,r.aC)(),[s,l]=(0,n.useState)([]),[o,x]=(0,n.useState)([]),[m,h]=(0,n.useState)(null),[j,g]=(0,n.useState)(!0),[f,R]=(0,n.useState)(!1),[Z,D]=(0,n.useState)(""),[S,C]=(0,n.useState)(""),[O,T]=(0,n.useState)("scheduled"),[M,P]=(0,n.useState)(!1),[k,I]=(0,n.useState)(!1),[A,E]=(0,n.useState)(null),[q,Y]=(0,n.useState)({name:"",description:"",reportType:"portfolio",frequency:"monthly",recipients:[{email:"",name:"",role:""}],settings:{includeCharts:!0,includeRawData:!1,dateRange:"last_month",format:"pdf"},schedule:{dayOfMonth:1,time:"09:00",timezone:"UTC"},isActive:!0}),[_,F]=(0,n.useState)({name:"",reportType:"portfolio",dateRange:{start:new Date(new Date().getFullYear(),new Date().getMonth()-1,1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},includeCharts:!0,includeRawData:!1,format:"pdf",recipients:[""]});(0,n.useEffect)(()=>{U()},[]);let U=async()=>{g(!0);try{let[e,t,s]=await Promise.all([eC(),eF(void 0,void 0,50),eU()]);l(e),x(t),h(s)}catch(e){D(e.message)}finally{g(!1)}},z=async()=>{if(t){R(!0),D("");try{await eS(q,t.id,t.name),C("Scheduled report created successfully!"),P(!1),V(),await U()}catch(e){D(e.message)}finally{R(!1)}}},B=async()=>{if(t&&A){R(!0),D("");try{await eO(A.id,q,t.id),C("Scheduled report updated successfully!"),E(null),P(!1),await U()}catch(e){D(e.message)}finally{R(!1)}}},K=async e=>{if(t&&confirm("Are you sure you want to delete this scheduled report?"))try{await eT(e,t.id),C("Scheduled report deleted successfully!"),await U()}catch(e){D(e.message)}},G=async(e,s)=>{if(t)try{await eO(e,{isActive:!s},t.id),C("Report ".concat(s?"deactivated":"activated"," successfully!")),await U()}catch(e){D(e.message)}},L=async()=>{if(t){R(!0),D("");try{let e={start:new Date(_.dateRange.start),end:new Date(_.dateRange.end)},s=_.recipients.filter(e=>""!==e.trim());await eM(_.reportType,{name:_.name,dateRange:e,includeCharts:_.includeCharts,includeRawData:_.includeRawData,format:_.format,recipients:s.length>0?s:void 0},t.id,t.name),C("Report generated successfully!"),I(!1),J(),await U()}catch(e){D(e.message)}finally{R(!1)}}},V=()=>{Y({name:"",description:"",reportType:"portfolio",frequency:"monthly",recipients:[{email:"",name:"",role:""}],settings:{includeCharts:!0,includeRawData:!1,dateRange:"last_month",format:"pdf"},schedule:{dayOfMonth:1,time:"09:00",timezone:"UTC"},isActive:!0})},J=()=>{F({name:"",reportType:"portfolio",dateRange:{start:new Date(new Date().getFullYear(),new Date().getMonth()-1,1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},includeCharts:!0,includeRawData:!1,format:"pdf",recipients:[""]})},$=e=>{Y(t=>({...t,recipients:t.recipients.filter((t,s)=>s!==e)}))},H=(e,t,s)=>{Y(a=>({...a,recipients:a.recipients.map((a,n)=>n===e?{...a,[t]:s}:a)}))},X=e=>{E(e),Y({name:e.name,description:e.description,reportType:e.reportType,frequency:e.frequency,recipients:e.recipients,settings:e.settings,schedule:e.schedule,isActive:e.isActive}),P(!0)},W=e=>({generating:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800",sent:"bg-blue-100 text-blue-800"})[e]||"bg-gray-100 text-gray-800",ee=e=>({daily:"bg-blue-100 text-blue-800",weekly:"bg-green-100 text-green-800",monthly:"bg-purple-100 text-purple-800",quarterly:"bg-orange-100 text-orange-800"})[e]||"bg-gray-100 text-gray-800";return j?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(v.O,{className:"h-8 w-64"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(e=>(0,a.jsx)(v.O,{className:"h-24"},e))}),(0,a.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,a.jsx)(v.O,{className:"h-32 w-full"},e))})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Reports Manager"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Generate and schedule automated reports for your property portfolio"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(y.z,{variant:"outline",onClick:()=>I(!0),children:[(0,a.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Generate Report"]}),(0,a.jsxs)(y.z,{onClick:()=>P(!0),children:[(0,a.jsx)(eg.Z,{className:"mr-2 h-4 w-4"}),"Schedule Report"]})]})]}),Z&&(0,a.jsxs)(N.bZ,{variant:"destructive",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4"}),(0,a.jsx)(N.X,{children:Z})]}),S&&(0,a.jsxs)(N.bZ,{children:[(0,a.jsx)(ex.Z,{className:"h-4 w-4"}),(0,a.jsx)(N.X,{children:S})]}),m&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Scheduled Reports"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:m.totalScheduled}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[m.activeScheduled," active"]})]}),(0,a.jsx)(er.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Reports"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:m.totalGenerated}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[m.recentlyGenerated," in last 24h"]})]}),(0,a.jsx)(u.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Most Popular"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:(null===(e=Object.entries(m.byType).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s})[0])||void 0===e?void 0:e[0])||"N/A"})]}),(0,a.jsx)(p.Z,{className:"h-8 w-8 text-muted-foreground"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Success Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[m.totalGenerated>0?Math.round(((m.byStatus.completed||0)+(m.byStatus.sent||0))/m.totalGenerated*100):0,"%"]})]}),(0,a.jsx)(ex.Z,{className:"h-8 w-8 text-green-500"})]})})})]}),(0,a.jsxs)(i.mQ,{value:O,onValueChange:T,className:"w-full",children:[(0,a.jsxs)(i.dr,{className:"grid w-full grid-cols-2",children:[(0,a.jsxs)(i.SP,{value:"scheduled",children:["Scheduled Reports (",s.length,")"]}),(0,a.jsxs)(i.SP,{value:"generated",children:["Generated Reports (",o.length,")"]})]}),(0,a.jsx)(i.nU,{value:"scheduled",className:"space-y-4",children:0===s.length?(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"flex items-center justify-center h-32",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(er.Z,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No scheduled reports yet"}),(0,a.jsx)(y.z,{className:"mt-2",onClick:()=>P(!0),children:"Create your first scheduled report"})]})})}):(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"pt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(d.C,{className:ee(e.frequency),children:e.frequency}),(0,a.jsx)(d.C,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Report Type:"})," ",e.reportType.replace("_"," ").toUpperCase()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Next Run:"})," ",(0,ew.WU)(e.nextRun.toDate(),"MMM dd, yyyy HH:mm")]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Recipients:"})," ",e.recipients.length]})]}),e.lastRun&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-muted-foreground",children:[(0,a.jsx)("strong",{children:"Last Run:"})," ",(0,ew.WU)(e.lastRun.toDate(),"MMM dd, yyyy HH:mm")]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[(0,a.jsx)(y.z,{variant:"outline",size:"sm",onClick:()=>G(e.id,e.isActive),children:e.isActive?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ef.Z,{className:"w-3 h-3 mr-1"}),"Pause"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ey.Z,{className:"w-3 h-3 mr-1"}),"Activate"]})}),(0,a.jsxs)(y.z,{variant:"outline",size:"sm",onClick:()=>X(e),children:[(0,a.jsx)(eN.Z,{className:"w-3 h-3 mr-1"}),"Edit"]}),(0,a.jsxs)(y.z,{variant:"outline",size:"sm",onClick:()=>K(e.id),children:[(0,a.jsx)(ev.Z,{className:"w-3 h-3 mr-1"}),"Delete"]})]})]})},e.id))})}),(0,a.jsx)(i.nU,{value:"generated",className:"space-y-4",children:0===o.length?(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"flex items-center justify-center h-32",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(u.Z,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No generated reports yet"}),(0,a.jsx)(y.z,{className:"mt-2",onClick:()=>I(!0),children:"Generate your first report"})]})})}):(0,a.jsx)("div",{className:"space-y-4",children:o.map(e=>(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"pt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.reportType.replace("_"," ").toUpperCase()," Report"]})]}),(0,a.jsx)(d.C,{className:W(e.status),children:e.status.replace("_"," ").toUpperCase()})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Generated:"})," ",(0,ew.WU)(e.generatedAt.toDate(),"MMM dd, yyyy HH:mm")]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"By:"})," ",e.generatedByName]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Records:"})," ",e.metadata.recordCount.toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Processing:"})," ",(e.metadata.processingTime/1e3).toFixed(2),"s"]})]}),e.errorMessage&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:[(0,a.jsx)("strong",{children:"Error:"})," ",e.errorMessage]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 mt-4",children:[e.fileUrls.pdf&&(0,a.jsxs)(y.z,{variant:"outline",size:"sm",children:[(0,a.jsx)(w.Z,{className:"w-3 h-3 mr-1"}),"PDF"]}),e.fileUrls.csv&&(0,a.jsxs)(y.z,{variant:"outline",size:"sm",children:[(0,a.jsx)(w.Z,{className:"w-3 h-3 mr-1"}),"CSV"]}),(0,a.jsxs)(y.z,{variant:"outline",size:"sm",children:[(0,a.jsx)(eb.Z,{className:"w-3 h-3 mr-1"}),"View"]})]})]})},e.id))})})]}),M&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)(c.Zb,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:A?"Edit Scheduled Report":"Create Scheduled Report"})}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Report Name"}),(0,a.jsx)(eu.I,{value:q.name,onChange:e=>Y(t=>({...t,name:e.target.value})),placeholder:"Weekly Portfolio Report"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Report Type"}),(0,a.jsxs)(Q.Ph,{value:q.reportType,onValueChange:e=>Y(t=>({...t,reportType:e})),children:[(0,a.jsx)(Q.i4,{children:(0,a.jsx)(Q.ki,{})}),(0,a.jsxs)(Q.Bw,{children:[(0,a.jsx)(Q.Ql,{value:"portfolio",children:"Portfolio Overview"}),(0,a.jsx)(Q.Ql,{value:"financial",children:"Financial Performance"}),(0,a.jsx)(Q.Ql,{value:"tenant",children:"Tenant Analytics"}),(0,a.jsx)(Q.Ql,{value:"maintenance",children:"Maintenance Analytics"}),(0,a.jsx)(Q.Ql,{value:"comprehensive",children:"Comprehensive Report"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Description"}),(0,a.jsx)(ep.g,{value:q.description,onChange:e=>Y(t=>({...t,description:e.target.value})),placeholder:"Describe what this report covers..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Frequency"}),(0,a.jsxs)(Q.Ph,{value:q.frequency,onValueChange:e=>Y(t=>({...t,frequency:e})),children:[(0,a.jsx)(Q.i4,{children:(0,a.jsx)(Q.ki,{})}),(0,a.jsxs)(Q.Bw,{children:[(0,a.jsx)(Q.Ql,{value:"daily",children:"Daily"}),(0,a.jsx)(Q.Ql,{value:"weekly",children:"Weekly"}),(0,a.jsx)(Q.Ql,{value:"monthly",children:"Monthly"}),(0,a.jsx)(Q.Ql,{value:"quarterly",children:"Quarterly"})]})]})]}),"monthly"===q.frequency&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Day of Month"}),(0,a.jsx)(eu.I,{type:"number",min:"1",max:"31",value:q.schedule.dayOfMonth,onChange:e=>Y(t=>({...t,schedule:{...t.schedule,dayOfMonth:parseInt(e.target.value)||1}}))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Time"}),(0,a.jsx)(eu.I,{type:"time",value:q.schedule.time,onChange:e=>Y(t=>({...t,schedule:{...t.schedule,time:e.target.value}}))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(ej._,{children:"Recipients"}),(0,a.jsxs)(y.z,{variant:"outline",size:"sm",onClick:()=>{Y(e=>({...e,recipients:[...e.recipients,{email:"",name:"",role:""}]}))},children:[(0,a.jsx)(eg.Z,{className:"w-3 h-3 mr-1"}),"Add Recipient"]})]}),(0,a.jsx)("div",{className:"space-y-2",children:q.recipients.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-2 items-end",children:[(0,a.jsx)("div",{className:"col-span-4",children:(0,a.jsx)(eu.I,{placeholder:"Email",value:e.email,onChange:e=>H(t,"email",e.target.value)})}),(0,a.jsx)("div",{className:"col-span-3",children:(0,a.jsx)(eu.I,{placeholder:"Name",value:e.name,onChange:e=>H(t,"name",e.target.value)})}),(0,a.jsx)("div",{className:"col-span-3",children:(0,a.jsx)(eu.I,{placeholder:"Role",value:e.role,onChange:e=>H(t,"role",e.target.value)})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)(y.z,{variant:"outline",size:"sm",onClick:()=>$(t),disabled:1===q.recipients.length,children:(0,a.jsx)(ev.Z,{className:"w-3 h-3"})})})]},t))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Date Range"}),(0,a.jsxs)(Q.Ph,{value:q.settings.dateRange,onValueChange:e=>Y(t=>({...t,settings:{...t.settings,dateRange:e}})),children:[(0,a.jsx)(Q.i4,{children:(0,a.jsx)(Q.ki,{})}),(0,a.jsxs)(Q.Bw,{children:[(0,a.jsx)(Q.Ql,{value:"last_month",children:"Last Month"}),(0,a.jsx)(Q.Ql,{value:"last_quarter",children:"Last Quarter"}),(0,a.jsx)(Q.Ql,{value:"last_year",children:"Last Year"}),(0,a.jsx)(Q.Ql,{value:"ytd",children:"Year to Date"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Format"}),(0,a.jsxs)(Q.Ph,{value:q.settings.format,onValueChange:e=>Y(t=>({...t,settings:{...t.settings,format:e}})),children:[(0,a.jsx)(Q.i4,{children:(0,a.jsx)(Q.ki,{})}),(0,a.jsxs)(Q.Bw,{children:[(0,a.jsx)(Q.Ql,{value:"pdf",children:"PDF Only"}),(0,a.jsx)(Q.Ql,{value:"csv",children:"CSV Only"}),(0,a.jsx)(Q.Ql,{value:"both",children:"Both PDF & CSV"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"includeCharts",checked:q.settings.includeCharts,onChange:e=>Y(t=>({...t,settings:{...t.settings,includeCharts:e.target.checked}}))}),(0,a.jsx)(ej._,{htmlFor:"includeCharts",children:"Include Charts"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"includeRawData",checked:q.settings.includeRawData,onChange:e=>Y(t=>({...t,settings:{...t.settings,includeRawData:e.target.checked}}))}),(0,a.jsx)(ej._,{htmlFor:"includeRawData",children:"Include Raw Data"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"isActive",checked:q.isActive,onChange:e=>Y(t=>({...t,isActive:e.target.checked}))}),(0,a.jsx)(ej._,{htmlFor:"isActive",children:"Active"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(y.z,{variant:"outline",onClick:()=>{P(!1),E(null),V()},children:"Cancel"}),(0,a.jsx)(y.z,{onClick:A?B:z,disabled:f,children:f?"Saving...":A?"Update Report":"Create Report"})]})]})]})}),k&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)(c.Zb,{className:"w-full max-w-xl",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Generate Report"})}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Report Name"}),(0,a.jsx)(eu.I,{value:_.name,onChange:e=>F(t=>({...t,name:e.target.value})),placeholder:"Monthly Portfolio Report - March 2024"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Report Type"}),(0,a.jsxs)(Q.Ph,{value:_.reportType,onValueChange:e=>F(t=>({...t,reportType:e})),children:[(0,a.jsx)(Q.i4,{children:(0,a.jsx)(Q.ki,{})}),(0,a.jsxs)(Q.Bw,{children:[(0,a.jsx)(Q.Ql,{value:"portfolio",children:"Portfolio Overview"}),(0,a.jsx)(Q.Ql,{value:"financial",children:"Financial Performance"}),(0,a.jsx)(Q.Ql,{value:"tenant",children:"Tenant Analytics"}),(0,a.jsx)(Q.Ql,{value:"maintenance",children:"Maintenance Analytics"}),(0,a.jsx)(Q.Ql,{value:"comprehensive",children:"Comprehensive Report"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Start Date"}),(0,a.jsx)(eu.I,{type:"date",value:_.dateRange.start,onChange:e=>F(t=>({...t,dateRange:{...t.dateRange,start:e.target.value}}))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"End Date"}),(0,a.jsx)(eu.I,{type:"date",value:_.dateRange.end,onChange:e=>F(t=>({...t,dateRange:{...t.dateRange,end:e.target.value}}))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ej._,{children:"Format"}),(0,a.jsxs)(Q.Ph,{value:_.format,onValueChange:e=>F(t=>({...t,format:e})),children:[(0,a.jsx)(Q.i4,{children:(0,a.jsx)(Q.ki,{})}),(0,a.jsxs)(Q.Bw,{children:[(0,a.jsx)(Q.Ql,{value:"pdf",children:"PDF Only"}),(0,a.jsx)(Q.Ql,{value:"csv",children:"CSV Only"}),(0,a.jsx)(Q.Ql,{value:"both",children:"Both PDF & CSV"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"genIncludeCharts",checked:_.includeCharts,onChange:e=>F(t=>({...t,includeCharts:e.target.checked}))}),(0,a.jsx)(ej._,{htmlFor:"genIncludeCharts",children:"Include Charts"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"genIncludeRawData",checked:_.includeRawData,onChange:e=>F(t=>({...t,includeRawData:e.target.checked}))}),(0,a.jsx)(ej._,{htmlFor:"genIncludeRawData",children:"Include Raw Data"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(y.z,{variant:"outline",onClick:()=>{I(!1),J()},children:"Cancel"}),(0,a.jsx)(y.z,{onClick:L,disabled:f,children:f?"Generating...":"Generate Report"})]})]})]})})]})}function eB(){let{user:e,loading:t}=(0,r.aC)(),[s,y]=(0,n.useState)("overview");return t?(0,a.jsx)("div",{children:"Loading..."}):(e||(0,l.redirect)("/login"),["admin","owner","agent"].includes(e.role))?(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Analytics Dashboard"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Comprehensive insights into your property portfolio performance"})]}),(0,a.jsx)(d.C,{variant:"outline",className:"px-3 py-1",children:"Real-time Data"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsx)(c.Zb,{className:"cursor-pointer transition-colors ".concat("overview"===s?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"),onClick:()=>y("overview"),children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Portfolio"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:"Overview"})]}),(0,a.jsx)(o.Z,{className:"h-6 w-6 text-blue-500"})]})})}),(0,a.jsx)(c.Zb,{className:"cursor-pointer transition-colors ".concat("financial"===s?"ring-2 ring-green-500 bg-green-50":"hover:bg-gray-50"),onClick:()=>y("financial"),children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Financial"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:"Performance"})]}),(0,a.jsx)(x.Z,{className:"h-6 w-6 text-green-500"})]})})}),(0,a.jsx)(c.Zb,{className:"cursor-pointer transition-colors ".concat("tenants"===s?"ring-2 ring-purple-500 bg-purple-50":"hover:bg-gray-50"),onClick:()=>y("tenants"),children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Tenant &"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:"Leases"})]}),(0,a.jsx)(m.Z,{className:"h-6 w-6 text-purple-500"})]})})}),(0,a.jsx)(c.Zb,{className:"cursor-pointer transition-colors ".concat("maintenance"===s?"ring-2 ring-orange-500 bg-orange-50":"hover:bg-gray-50"),onClick:()=>y("maintenance"),children:(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Maintenance"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:"Analytics"})]}),(0,a.jsx)(h.Z,{className:"h-6 w-6 text-orange-500"})]})})})]}),(0,a.jsxs)(i.mQ,{value:s,onValueChange:y,className:"w-full",children:[(0,a.jsxs)(i.dr,{className:"grid w-full grid-cols-5",children:[(0,a.jsxs)(i.SP,{value:"overview",className:"flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Portfolio"})]}),(0,a.jsxs)(i.SP,{value:"financial",className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Financial"})]}),(0,a.jsxs)(i.SP,{value:"tenants",className:"flex items-center space-x-2",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Tenants"})]}),(0,a.jsxs)(i.SP,{value:"maintenance",className:"flex items-center space-x-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Maintenance"})]}),(0,a.jsxs)(i.SP,{value:"reports",className:"flex items-center space-x-2",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Reports"})]})]}),(0,a.jsx)(i.nU,{value:"overview",className:"space-y-6 mt-6",children:(0,a.jsx)(L,{})}),(0,a.jsx)(i.nU,{value:"financial",className:"space-y-6 mt-6",children:(0,a.jsx)(ee,{})}),(0,a.jsx)(i.nU,{value:"tenants",className:"space-y-6 mt-6",children:(0,a.jsx)(eo,{})}),(0,a.jsx)(i.nU,{value:"maintenance",className:"space-y-6 mt-6",children:(0,a.jsx)(eh,{})}),(0,a.jsx)(i.nU,{value:"reports",className:"space-y-6 mt-6",children:(0,a.jsx)(ez,{})})]}),(0,a.jsxs)(c.Zb,{className:"mt-8",children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(j.Z,{className:"mr-2 h-5 w-5"}),"Analytics Features"]}),(0,a.jsx)(c.SZ,{children:"Comprehensive reporting and insights across all aspects of your property management"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5 text-blue-500"}),(0,a.jsx)("h3",{className:"font-semibold",children:"Portfolio Analytics"})]}),(0,a.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-1",children:[(0,a.jsx)("li",{children:" Property performance comparison"}),(0,a.jsx)("li",{children:" Occupancy rate tracking"}),(0,a.jsx)("li",{children:" ROI analysis by property"}),(0,a.jsx)("li",{children:" Portfolio value assessment"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5 text-green-500"}),(0,a.jsx)("h3",{className:"font-semibold",children:"Financial Reporting"})]}),(0,a.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-1",children:[(0,a.jsx)("li",{children:" Revenue vs expense analysis"}),(0,a.jsx)("li",{children:" Profit margin tracking"}),(0,a.jsx)("li",{children:" Cash flow monitoring"}),(0,a.jsx)("li",{children:" Collection rate metrics"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 text-purple-500"}),(0,a.jsx)("h3",{className:"font-semibold",children:"Tenant Insights"})]}),(0,a.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-1",children:[(0,a.jsx)("li",{children:" Tenant retention analysis"}),(0,a.jsx)("li",{children:" Lease renewal tracking"}),(0,a.jsx)("li",{children:" Demographic breakdowns"}),(0,a.jsx)("li",{children:" Satisfaction scoring"})]})]})]})})]})]}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),(0,a.jsx)("p",{className:"text-gray-600",children:"You don't have permission to view analytics."})]})})}},12339:function(e,t,s){"use strict";s.d(t,{SP:function(){return d},dr:function(){return c},mQ:function(){return i},nU:function(){return o}});var a=s(57437),n=s(2265),r=s(20271),l=s(94508);let i=r.fC,c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.aV,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...n})});c.displayName=r.aV.displayName;let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.xz,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...n})});d.displayName=r.xz.displayName;let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.VY,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...n})});o.displayName=r.VY.displayName}},function(e){e.O(0,[4358,139,92,5189,7746,3825,2093,4193,271,4067,9984,6729,2971,2117,1744],function(){return e(e.s=44014)}),_N_E=e.O()}]);